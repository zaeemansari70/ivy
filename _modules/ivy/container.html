

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ivy.container &mdash; Ivy 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Ivy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extensions.html">Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
</ul>
<p class="caption"><span class="caption-text">Functional</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/activations.html">Activations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/compilation.html">Compilation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/constants.html">Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/creation.html">Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/data_type.html">Data type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/device.html">Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/elementwise.html">Elementwise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/general.html">General</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/gradients.html">Gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/image.html">Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/layers.html">Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/linear_algebra.html">Linear algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/losses.html">Losses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/manipulation.html">Manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/meta.html">Meta</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/nest.html">Nest</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/norms.html">Norms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/random.html">Random</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/searching.html">Searching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/set.html">Set</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/sorting.html">Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/statistical.html">Statistical</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional/ivy/utility.html">Utility</a></li>
</ul>
<p class="caption"><span class="caption-text">Stateful</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../stateful/activations.html">Activations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../stateful/converters.html">Converters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../stateful/initializers.html">Initializers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../stateful/layers.html">Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../stateful/module.html">Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../stateful/norms.html">Norms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../stateful/optimizers.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../stateful/sequential.html">Sequential</a></li>
</ul>
<p class="caption"><span class="caption-text">Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../ivy"">Ivy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mech"">Ivy mech</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../vision"">Ivy vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../robot"">Ivy robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gym"">Ivy gym</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../memory"">Ivy memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../builder"">Ivy builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../models"">Ivy models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ecosystem"">Ivy ecosystem</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Ivy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>ivy.container</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for ivy.container</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Base Container Object</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># global</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">termcolor</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">_np</span>
<span class="kn">import</span> <span class="nn">json</span> <span class="k">as</span> <span class="nn">_json</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># noinspection PyPackageRequirements</span>
    <span class="kn">import</span> <span class="nn">h5py</span> <span class="k">as</span> <span class="nn">_h5py</span>
<span class="k">except</span> <span class="ne">ModuleNotFoundError</span><span class="p">:</span>
    <span class="n">_h5py</span> <span class="o">=</span> <span class="kc">None</span>
<span class="kn">import</span> <span class="nn">pickle</span> <span class="k">as</span> <span class="nn">_pickle</span>
<span class="kn">import</span> <span class="nn">random</span> <span class="k">as</span> <span class="nn">_random</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">lt</span> <span class="k">as</span> <span class="n">_lt</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">le</span> <span class="k">as</span> <span class="n">_le</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">eq</span> <span class="k">as</span> <span class="n">_eq</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">ne</span> <span class="k">as</span> <span class="n">_ne</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">gt</span> <span class="k">as</span> <span class="n">_gt</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">ge</span> <span class="k">as</span> <span class="n">_ge</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">mul</span> <span class="k">as</span> <span class="n">_mul</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="nb">pow</span> <span class="k">as</span> <span class="n">_pow</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">not_</span> <span class="k">as</span> <span class="n">_not</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span> <span class="k">as</span> <span class="n">_reduce</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Dict</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">truediv</span> <span class="k">as</span> <span class="n">_truediv</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">floordiv</span> <span class="k">as</span> <span class="n">_floordiv</span>

<span class="c1"># local</span>
<span class="kn">import</span> <span class="nn">ivy</span>

<span class="n">ansi_escape</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\x1B(?:[@-Z</span><span class="se">\\</span><span class="s1">-_]|\[[0-?]*[ -/]*[@-~])&#39;</span><span class="p">)</span>
<span class="n">base_cont</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">_is_jsonable</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">_json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">OverflowError</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="k">def</span> <span class="nf">_repr</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="c1"># noinspection PyMissingConstructor</span>
<div class="viewcode-block" id="Container"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container">[docs]</a><span class="k">class</span> <span class="nc">Container</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>

<div class="viewcode-block" id="Container.__init__"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dict_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">queues</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">queue_load_sizes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">container_combine_method</span><span class="o">=</span><span class="s1">&#39;list_join&#39;</span><span class="p">,</span>
                 <span class="n">queue_timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">key_length_limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">print_line_spacing</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">ivyh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_key_color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">keyword_color_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rebuild_child_containers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">types_to_iteratively_nest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alphabetical_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize container object from input dict representation.</span>

<span class="sd">        :param dict_in: the dictionary the container should wrap around. Default is None.</span>
<span class="sd">        :type dict_in: dict, optional</span>
<span class="sd">        :param queues: Sequence of multiprocessing queues, each of which returns containers.</span>
<span class="sd">                       This enables the current container to be passed around asynchronously while waiting for data.</span>
<span class="sd">                       Default is None.</span>
<span class="sd">        :type queues: sequence of multiprocessing queues, optional</span>
<span class="sd">        :param queue_load_sizes: Size of leading dimension of the containers returned by each queue. Default is None.</span>
<span class="sd">        :type queue_load_sizes: sequence of ints, optional</span>
<span class="sd">        :param container_combine_method: The method to use for combining containers arriving from different queues.</span>
<span class="sd">                                         Default is ivy.Container.list_join</span>
<span class="sd">        :type container_combine_method: str, optional</span>
<span class="sd">        :param queue_timeout: The timeout when waiting for containers to arrive from the queues. Default is global.</span>
<span class="sd">        :type queue_timeout: float, optional</span>
<span class="sd">        :param print_limit: The total array size limit when printing the container. Default is 10.</span>
<span class="sd">        :type print_limit: int, optional</span>
<span class="sd">        :param key_length_limit: The maximum key length when printing the container. Default is None.</span>
<span class="sd">        :type key_length_limit: int, optional</span>
<span class="sd">        :param print_indent: The number of whitespaces to use for indenting when printing the container. Default is 4.</span>
<span class="sd">        :type print_indent: int, optional</span>
<span class="sd">        :param print_line_spacing: The number of extra newlines to use between keys when printing the container.</span>
<span class="sd">                                   Default is 0.</span>
<span class="sd">        :type print_line_spacing: int, optional</span>
<span class="sd">        :param ivyh: Handle to ivy module to use for the calculations. Default is None, which results in the global ivy.</span>
<span class="sd">        :type ivyh: handle to ivy module, optional</span>
<span class="sd">        :param default_key_color: The default key color for printing the container to the terminal. Default is &#39;green&#39;.</span>
<span class="sd">        :type default_key_color: str, optional</span>
<span class="sd">        :param keyword_color_dict: A dict mapping keywords to their termcolor color codes for printing the container.</span>
<span class="sd">        :type keyword_color_dict: dict, optional</span>
<span class="sd">        :param rebuild_child_containers: Whether to rebuild container found in dict_in with these constructor params.</span>
<span class="sd">                                         Default is False, in which case the original container are kept as are.</span>
<span class="sd">        :type rebuild_child_containers: bool, optional</span>
<span class="sd">        :param types_to_iteratively_nest: The data types to nest iteratively in the dict structure, each type must be</span>
<span class="sd">                                          iterable. Default is None.</span>
<span class="sd">        :type types_to_iteratively_nest: seq of iterable types</span>
<span class="sd">        :param alphabetical_keys: Whether to sort the container keys alphabetically, or preserve the dict order.</span>
<span class="sd">                                  Default is True.</span>
<span class="sd">        :type alphabetical_keys: bool, optional</span>
<span class="sd">        :param kwargs: keyword arguments for dict creation. Default is None.</span>
<span class="sd">        :type kwargs: keyword arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queues</span> <span class="o">=</span> <span class="n">queues</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_container_combine_method</span> <span class="o">=</span> <span class="n">container_combine_method</span>
        <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queues</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_container_combine_method</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_container_combine_method</span> <span class="o">=</span>\
                    <span class="p">{</span><span class="s1">&#39;list_join&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_join</span><span class="p">,</span>
                     <span class="s1">&#39;concat&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">conts</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">conts</span><span class="p">,</span> <span class="mi">0</span><span class="p">)}[</span><span class="bp">self</span><span class="o">.</span><span class="n">_container_combine_method</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_loaded_containers_from_queues</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queue_load_sizes_cum</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">queue_load_sizes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queue_timeout</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">queue_timeout</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">queue_timeout</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">dict_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">dict_in</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dict_in</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;dict_in and **kwargs cannot both be specified for ivy.Container constructor,&#39;</span>
                            <span class="s1">&#39;please specify one or the other, not both.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config_in</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">print_limit</span><span class="o">=</span><span class="n">print_limit</span><span class="p">,</span> <span class="n">print_indent</span><span class="o">=</span><span class="n">print_indent</span><span class="p">,</span> <span class="n">key_length_limit</span><span class="o">=</span><span class="n">key_length_limit</span><span class="p">,</span>
            <span class="n">print_line_spacing</span><span class="o">=</span><span class="n">print_line_spacing</span><span class="p">,</span> <span class="n">ivyh</span><span class="o">=</span><span class="n">ivyh</span><span class="p">,</span> <span class="n">default_key_color</span><span class="o">=</span><span class="n">default_key_color</span><span class="p">,</span>
            <span class="n">keyword_color_dict</span><span class="o">=</span><span class="n">keyword_color_dict</span><span class="p">,</span> <span class="n">rebuild_child_containers</span><span class="o">=</span><span class="n">rebuild_child_containers</span><span class="p">,</span>
            <span class="n">types_to_iteratively_nest</span><span class="o">=</span><span class="n">types_to_iteratively_nest</span><span class="p">,</span> <span class="n">alphabetical_keys</span><span class="o">=</span><span class="n">alphabetical_keys</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inplace_update</span><span class="p">(</span><span class="n">dict_in</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_in</span><span class="p">)</span></div>

    <span class="c1"># Class Methods #</span>
    <span class="c1"># --------------#</span>

<div class="viewcode-block" id="Container.list_join"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.list_join">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">list_join</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Join containers of lists together along the specified dimension.</span>

<span class="sd">        :param containers: containers to list join</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        :param config: The configuration for the containers. Default is the same as container0.</span>
<span class="sd">        :type config: dict, optional</span>
<span class="sd">        :return: List joined containers, with each entry being a list of arrays</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">container0</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">container0</span><span class="o">.</span><span class="n">config</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">container0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">:</span>
                    <span class="n">new_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">container</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">list_join</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">containers</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span></div>

<div class="viewcode-block" id="Container.list_stack"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.list_stack">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">list_stack</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List stack containers together along the specified dimension.</span>

<span class="sd">        :param containers: containers to list stack</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        :param dim: dimension along which to list stack</span>
<span class="sd">        :type dim: int</span>
<span class="sd">        :param config: The configuration for the containers. Default is the same as container0.</span>
<span class="sd">        :type config: dict, optional</span>
<span class="sd">        :return: Stacked containers, with each entry being a list of arrays</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">container0</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">container0</span><span class="o">.</span><span class="n">config</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">container0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">list_stack</span><span class="p">([</span><span class="n">container</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">],</span> <span class="n">dim</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">containers</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_concat_unify</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">dev</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Container</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">cont</span><span class="o">.</span><span class="n">to_dev</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span> <span class="n">axis</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_sum_unify</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">dev</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_1</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">cont</span><span class="o">.</span><span class="n">to_dev</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_mean_unify</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">dev</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_1</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Container</span><span class="o">.</span><span class="n">_sum_unify</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">containers</span><span class="p">)</span>

<div class="viewcode-block" id="Container.unify"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.unify">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">unify</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">dev</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unify a list of containers, on arbitrary devices, to a single container on the specified device.</span>

<span class="sd">        :param containers: containers to unify</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        :param dev: The device to unify the containers to.</span>
<span class="sd">        :type dev: ivy.Device</span>
<span class="sd">        :param mode: The mode by which to unify, must be one of [ concat | mean | sum ]</span>
<span class="sd">        :type mode: str</span>
<span class="sd">        :param axis: The axis along which to concattenate the container, if concat mode is set. Default is 0.</span>
<span class="sd">        :type axis: int, optional</span>
<span class="sd">        :return: Unified container</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;concat&#39;</span><span class="p">:</span> <span class="n">Container</span><span class="o">.</span><span class="n">_concat_unify</span><span class="p">,</span>
                <span class="s1">&#39;sum&#39;</span><span class="p">:</span> <span class="n">Container</span><span class="o">.</span><span class="n">_sum_unify</span><span class="p">,</span>
                <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="n">Container</span><span class="o">.</span><span class="n">_mean_unify</span><span class="p">}[</span><span class="n">mode</span><span class="p">](</span><span class="n">containers</span><span class="p">,</span> <span class="n">dev</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.concat"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.concat">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Concatenate containers together along the specified dimension.</span>

<span class="sd">        :param containers: containers to concatenate</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        :param dim: dimension along which to concatenate</span>
<span class="sd">        :type dim: int</span>
<span class="sd">        :param config: The configuration for the containers. Default is the same as container0.</span>
<span class="sd">        :type config: dict, optional</span>
<span class="sd">        :return: Concatenated containers</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">container0</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">container0</span><span class="o">.</span><span class="n">config</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">container0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">container</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">],</span> <span class="n">dim</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># noinspection PyProtectedMember</span>
            <span class="n">ivyh</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;ivyh&#39;</span><span class="p">],</span> <span class="n">ivy</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="c1"># noinspection PyBroadException</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">ivyh</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">ivyh</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">dim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">],</span> <span class="n">dim</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">ivyh</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Container concat operation only valid for containers of arrays&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.stack"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.stack">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">stack</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stack containers together along the specified dimension.</span>

<span class="sd">        :param containers: containers to stack</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        :param dim: dimension along which to stack</span>
<span class="sd">        :type dim: int</span>
<span class="sd">        :param config: The configuration for the containers. Default is the same as container0.</span>
<span class="sd">        :type config: dict, optional</span>
<span class="sd">        :return: Stacked containers</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">container0</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">container0</span><span class="o">.</span><span class="n">config</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">container0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">container</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">],</span> <span class="n">dim</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># noinspection PyProtectedMember</span>
            <span class="n">ivyh</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;ivyh&#39;</span><span class="p">],</span> <span class="n">ivy</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="c1"># noinspection PyBroadException</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">ivyh</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">ivyh</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">dim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">],</span> <span class="n">dim</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">ivyh</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Container stack operation only valid for containers of arrays&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.combine"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.combine">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="o">*</span><span class="n">containers</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Combine keys and values in a sequence of containers, with priority given to the right-most container in the case</span>
<span class="sd">        of duplicates.</span>

<span class="sd">        :param containers: containers to compare</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        :param config: The configuration for the containers. Default is the same as container_rightmost.</span>
<span class="sd">        :type config: dict, optional</span>
<span class="sd">        :return: Combined containers</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># if inputs are not dicts, then simply return the right-most value</span>
        <span class="n">container_rightmost</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container_rightmost</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">container_rightmost</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="c1"># noinspection PyUnresolvedReferences</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">container_rightmost</span><span class="o">.</span><span class="n">config</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container_rightmost</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>

        <span class="c1"># return if len==1</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">containers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">container_rightmost</span>

        <span class="c1"># otherwise, check that the keys are aligned between each container, and apply this method recursively</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">all_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">cont</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">all_keys</span><span class="p">:</span>
            <span class="n">keys_present</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="ow">in</span> <span class="n">cont</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
            <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span>\
                <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">cont</span><span class="p">,</span> <span class="n">kp</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">keys_present</span><span class="p">)</span> <span class="k">if</span> <span class="n">kp</span><span class="p">],</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.diff"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.diff">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="o">*</span><span class="n">containers</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">diff_keys</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">detect_key_diffs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">detect_value_diffs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">detect_shape_diffs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compare keys and values in a sequence of containers, returning the single shared values where they are the same,</span>
<span class="sd">        and new nested sub-dicts with all values where they are different.</span>

<span class="sd">        :param containers: containers to compare</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        :param mode: The mode of the diff operation, returning either all keys and values,</span>
<span class="sd">                     only those that are consist across the containers, or only the differences. Default is all.</span>
<span class="sd">        :type mode: str, optional</span>
<span class="sd">        :param diff_keys: The key/keys to add to the returned container when differences are found. Default is &quot;diff&quot;.</span>
<span class="sd">        :type diff_keys: str or list of strs, optional</span>
<span class="sd">        :param detect_key_diffs: Whether to treat different keys as detected differences.</span>
<span class="sd">                                 If not, the keys among the input containers are simply combined without flagging</span>
<span class="sd">                                 differences. Default is True.</span>
<span class="sd">        :type detect_key_diffs: bool, optional</span>
<span class="sd">        :param detect_value_diffs: Whether to treat different values as detected differences. Default is True.</span>
<span class="sd">        :type detect_value_diffs: bool, optional</span>
<span class="sd">        :param detect_shape_diffs: Whether to treat different array shapes as detected differences. Default is True.</span>
<span class="sd">        :type detect_shape_diffs: bool, optional</span>
<span class="sd">        :param config: The configuration for the containers. Default is the same as container0.</span>
<span class="sd">        :type config: dict, optional</span>
<span class="sd">        :return: Compared containers</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;same_only&#39;</span><span class="p">,</span> <span class="s1">&#39;diff_only&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;mode must be one of [ &quot;all&quot; | &quot;same_only&quot; | &quot;diff_only&quot; ], but found </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>

        <span class="c1"># if inputs are not dicts, then compare their values to determine the diff dict</span>
        <span class="n">num_containers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">containers</span><span class="p">)</span>
        <span class="n">container0</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">container0</span><span class="o">.</span><span class="n">config</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">equal_mat</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">all_equal</span><span class="p">(</span><span class="o">*</span><span class="n">containers</span><span class="p">,</span> <span class="n">equality_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">detect_value_diffs</span><span class="p">:</span>
                <span class="n">equal_mat</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">equal_mat</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">detect_shape_diffs</span><span class="p">:</span>
                <span class="n">shape_equal_mat</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">all_equal</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">shape</span> <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">],</span>
                                                <span class="n">equality_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">equal_mat</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">equal_mat</span><span class="p">,</span> <span class="n">shape_equal_mat</span><span class="p">)</span>
            <span class="c1"># noinspection PyTypeChecker</span>
            <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">reduce_min</span><span class="p">(</span><span class="n">ivy</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">equal_mat</span><span class="p">,</span> <span class="s1">&#39;int32&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;diff_only&#39;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">container0</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;same_only&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cont_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_containers</span><span class="p">)</span>
                <span class="n">diff_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="n">cont_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">cont_range</span><span class="p">,</span> <span class="n">containers</span><span class="p">))</span>
                <span class="n">idxs_added</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">cont_range</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">idxs_added</span><span class="p">:</span>
                        <span class="n">idxs_to_add</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">indices_where</span><span class="p">(</span><span class="n">equal_mat</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
                        <span class="n">idxs_to_add_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ivy</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">idxs_to_add</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">diff_keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                            <span class="n">key</span> <span class="o">=</span> <span class="n">diff_keys</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">idxs_to_add_list</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">diff_keys</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                            <span class="n">key</span> <span class="o">=</span> <span class="n">diff_keys</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;diff_keys must be either a string or list of strings,&#39;</span>
                                            <span class="s1">&#39;but found </span><span class="si">{}</span><span class="s1"> of type </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">diff_keys</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">diff_keys</span><span class="p">)))</span>
                        <span class="n">diff_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">cont_dict</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                        <span class="n">idxs_added</span> <span class="o">+=</span> <span class="n">idxs_to_add_list</span>
                <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">diff_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>

        <span class="c1"># otherwise, check that the keys are aligned between each container, and apply this method recursively</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">all_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">cont</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">all_keys</span><span class="p">:</span>
            <span class="n">keys_present</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="ow">in</span> <span class="n">cont</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
            <span class="n">all_keys_present</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">keys_present</span><span class="p">)</span> <span class="o">==</span> <span class="n">num_containers</span>
            <span class="k">if</span> <span class="n">all_keys_present</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">],</span>
                                         <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">diff_keys</span><span class="o">=</span><span class="n">diff_keys</span><span class="p">,</span> <span class="n">detect_key_diffs</span><span class="o">=</span><span class="n">detect_key_diffs</span><span class="p">,</span>
                                         <span class="n">detect_value_diffs</span><span class="o">=</span><span class="n">detect_value_diffs</span><span class="p">,</span> <span class="n">detect_shape_diffs</span><span class="o">=</span><span class="n">detect_shape_diffs</span><span class="p">,</span>
                                         <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">or</span> <span class="n">res</span><span class="p">:</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="nb">sum</span><span class="p">(</span><span class="n">keys_present</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">detect_key_diffs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="n">keys_present</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">True</span><span class="p">)][</span><span class="n">key</span><span class="p">]</span>
                <span class="k">continue</span>
            <span class="n">diff_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">key_present</span><span class="p">,</span> <span class="n">cont</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys_present</span><span class="p">,</span> <span class="n">containers</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">detect_key_diffs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key_present</span> <span class="ow">and</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s1">&#39;same_only&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">diff_keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                            <span class="n">diff_dict</span><span class="p">[</span><span class="n">diff_keys</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">diff_keys</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                            <span class="n">diff_dict</span><span class="p">[</span><span class="n">diff_keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;diff_keys must be either a string or list of strings,&#39;</span>
                                            <span class="s1">&#39;but found </span><span class="si">{}</span><span class="s1"> of type </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">diff_keys</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">diff_keys</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">diff_dict</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">diff_dict</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.structural_diff"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.structural_diff">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">structural_diff</span><span class="p">(</span><span class="o">*</span><span class="n">containers</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">diff_keys</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="n">detect_key_diffs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">detect_shape_diffs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compare keys and shapes in a sequence of containers, returning the single shared values where they are the same,</span>
<span class="sd">        and new nested sub-dicts with all values where they are different.</span>

<span class="sd">        :param containers: containers to compare</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        :param mode: The mode of the diff operation, returning either all keys and values,</span>
<span class="sd">                     only those that are consist across the containers, or only the differences. Default is all.</span>
<span class="sd">        :type mode: str, optional</span>
<span class="sd">        :param diff_keys: The key/keys to add to the returned container when differences are found. Default is &quot;diff&quot;.</span>
<span class="sd">        :type diff_keys: str or list of strs, optional</span>
<span class="sd">        :param detect_key_diffs: Whether to treat different keys as detected differences.</span>
<span class="sd">                                 If not, the keys among the input containers are simply combined without flagging</span>
<span class="sd">                                 differences. Default is True.</span>
<span class="sd">        :type detect_key_diffs: bool, optional</span>
<span class="sd">        :param detect_shape_diffs: Whether to treat different array shapes as detected differences. Default is True.</span>
<span class="sd">        :type detect_shape_diffs: bool, optional</span>
<span class="sd">        :param config: The configuration for the containers. Default is the same as container0.</span>
<span class="sd">        :type config: dict, optional</span>
<span class="sd">        :return: Compared containers</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Container</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="o">*</span><span class="n">containers</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">diff_keys</span><span class="o">=</span><span class="n">diff_keys</span><span class="p">,</span> <span class="n">detect_key_diffs</span><span class="o">=</span><span class="n">detect_key_diffs</span><span class="p">,</span>
                              <span class="n">detect_value_diffs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">detect_shape_diffs</span><span class="o">=</span><span class="n">detect_shape_diffs</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.multi_map"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.multi_map">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">multi_map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">containers</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chain</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply function to all array values from a collection of identically structured containers.</span>

<span class="sd">        :param func: Function to apply to each container entry.</span>
<span class="sd">        :type func: python function</span>
<span class="sd">        :param containers: containers to map.</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied,</span>
<span class="sd">                                otherwise the leftmost container value is used. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param key_chain: Chain of keys for this dict entry</span>
<span class="sd">        :type key_chain: str</span>
<span class="sd">        :param config: The configuration for the containers. Default is the same as container0.</span>
<span class="sd">        :type config: dict, optional</span>
<span class="sd">        :return: Contaienr</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">container0</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">container0</span><span class="o">.</span><span class="n">config</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">container0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
            <span class="n">value0</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">this_key_chain</span> <span class="o">=</span> <span class="n">key</span> <span class="k">if</span> <span class="n">key_chain</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="p">(</span><span class="n">key_chain</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value0</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">multi_map</span><span class="p">(</span>
                    <span class="n">func</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">this_key_chain</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key_chains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">this_key_chain</span> <span class="ow">in</span> <span class="n">key_chains</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">to_apply</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                            <span class="n">this_key_chain</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key_chains</span> <span class="ow">and</span> <span class="n">to_apply</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">prune_unapplied</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value0</span>
                        <span class="k">continue</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">this_key_chain</span><span class="p">)</span>
        <span class="c1"># noinspection PyProtectedMember</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.common_key_chains"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.common_key_chains">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">common_key_chains</span><span class="p">(</span><span class="n">containers</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the key-chains common across all containers.</span>

<span class="sd">        :param containers: Containers to check.</span>
<span class="sd">        :type containers: list of containers</span>
<span class="sd">        :return: list of key-chains.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">containers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">all_key_chains</span><span class="p">()</span>
        <span class="n">sets</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">cont</span><span class="o">.</span><span class="n">all_key_chains</span><span class="p">())</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">sets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="o">*</span><span class="n">sets</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span></div>

<div class="viewcode-block" id="Container.identical"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.identical">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">identical</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">check_types</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">same_arrays</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arrays_equal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chain</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a single boolean as to whether the input containers have identical key-chains and data types.</span>

<span class="sd">        :param containers: containers to check.</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        :param check_types: Whether to check if the datatypes of the leaf nodes are the same. Default is True.</span>
<span class="sd">        :type check_types: bool, optional</span>
<span class="sd">        :param check_shapes: Whether to check if the shapes of the leaf nodes are the same. Default is True.</span>
<span class="sd">        :type check_shapes: bool, optional</span>
<span class="sd">        :param same_arrays: Whether to check if the arrays are the exact same instances. Default is True.</span>
<span class="sd">        :type same_arrays: bool, optional</span>
<span class="sd">        :param arrays_equal: Whether to check if the arrays have equal values. Default is True.</span>
<span class="sd">        :type arrays_equal: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param partial: Whether to also check for partially complete sub-containers. Default is False.</span>
<span class="sd">        :type partial: bool, optional</span>
<span class="sd">        :param key_chain: Chain of keys for this dict entry</span>
<span class="sd">        :type key_chain: str</span>
<span class="sd">        :return: Boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">partial</span><span class="p">:</span>
            <span class="n">common_key_chains</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">common_key_chains</span><span class="p">(</span><span class="n">containers</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">common_key_chains</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">containers</span> <span class="o">=</span> <span class="p">[</span><span class="n">cont</span><span class="o">.</span><span class="n">at_key_chains</span><span class="p">(</span><span class="n">common_key_chains</span><span class="p">)</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">sl</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">cont</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sl</span><span class="p">])</span>
        <span class="c1"># noinspection PyProtectedMember</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">min</span><span class="p">([</span><span class="n">key</span> <span class="ow">in</span> <span class="n">cont</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]):</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
            <span class="n">value_0</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">type_0</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">value_0</span><span class="p">)</span>
            <span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">min</span><span class="p">([</span><span class="n">type_n</span> <span class="ow">is</span> <span class="n">type_0</span> <span class="k">for</span> <span class="n">type_n</span> <span class="ow">in</span> <span class="n">types</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value_0</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span> <span class="ow">or</span> <span class="n">check_types</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">value_0</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">check_shapes</span><span class="p">:</span>
                    <span class="n">shape_0</span> <span class="o">=</span> <span class="n">value_0</span><span class="o">.</span><span class="n">shape</span>
                    <span class="n">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">min</span><span class="p">([</span><span class="n">shape_n</span> <span class="o">==</span> <span class="n">shape_0</span> <span class="k">for</span> <span class="n">shape_n</span> <span class="ow">in</span> <span class="n">shapes</span><span class="p">]):</span>
                        <span class="k">return</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">same_arrays</span><span class="p">:</span>
                    <span class="n">id_0</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="n">value_0</span><span class="p">)</span>
                    <span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">min</span><span class="p">([</span><span class="n">id_n</span> <span class="o">==</span> <span class="n">id_0</span> <span class="k">for</span> <span class="n">id_n</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]):</span>
                        <span class="k">return</span> <span class="kc">False</span>
                <span class="k">elif</span> <span class="n">arrays_equal</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">arrays_equal</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
                        <span class="k">return</span> <span class="kc">False</span>
            <span class="n">this_key_chain</span> <span class="o">=</span> <span class="n">key</span> <span class="k">if</span> <span class="n">key_chain</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="p">(</span><span class="n">key_chain</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value_0</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">identical</span><span class="p">(</span>
                    <span class="n">values</span><span class="p">,</span> <span class="n">check_types</span><span class="p">,</span> <span class="n">check_shapes</span><span class="p">,</span> <span class="n">same_arrays</span><span class="p">,</span> <span class="n">arrays_equal</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">partial</span><span class="p">,</span>
                    <span class="n">this_key_chain</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Container.assert_identical"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.assert_identical">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">assert_identical</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">check_types</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">same_arrays</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arrays_equal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assert whether the input containers are identical. Otherwise, the diff is shown in an exception.</span>

<span class="sd">        :param containers: containers to check.</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        :param check_types: Whether to check if the datatypes of the leaf nodes are the same. Default is True.</span>
<span class="sd">        :type check_types: bool, optional</span>
<span class="sd">        :param check_shapes: Whether to check if the shapes of the leaf nodes are the same. Default is True.</span>
<span class="sd">        :type check_shapes: bool, optional</span>
<span class="sd">        :param same_arrays: Whether to check if the arrays are the exact same instances. Default is True.</span>
<span class="sd">        :type same_arrays: bool, optional</span>
<span class="sd">        :param arrays_equal: Whether to check if the arrays have equal values. Default is True.</span>
<span class="sd">        :type arrays_equal: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param partial: Whether to also check for partially complete sub-containers. Default is False.</span>
<span class="sd">        :type partial: bool, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">Container</span><span class="o">.</span><span class="n">identical</span><span class="p">(</span>
            <span class="n">containers</span><span class="p">,</span> <span class="n">check_types</span><span class="p">,</span> <span class="n">check_shapes</span><span class="p">,</span> <span class="n">same_arrays</span><span class="p">,</span> <span class="n">arrays_equal</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">partial</span><span class="p">),</span>\
            <span class="s1">&#39;Containers were not identical:</span><span class="se">\n\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Container</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="o">*</span><span class="n">containers</span><span class="p">))</span></div>

<div class="viewcode-block" id="Container.identical_structure"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.identical_structure">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">identical_structure</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">check_types</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chain</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a single boolean as to whether the input containers have identical structure.</span>

<span class="sd">        :param containers: containers to check.</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        :param check_types: Whether to also check whether the datatypes of the leaf nodes are the same. Default is True.</span>
<span class="sd">        :type check_types: bool, optional</span>
<span class="sd">        :param check_shapes: Whether to also check whether the shapes of the leaf nodes are the same. Default is True.</span>
<span class="sd">        :type check_shapes: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param partial: Whether to also check for partially complete sub-containers. Default is False.</span>
<span class="sd">        :type partial: bool, optional</span>
<span class="sd">        :param key_chain: Chain of keys for this dict entry</span>
<span class="sd">        :type key_chain: str</span>
<span class="sd">        :return: Boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Container</span><span class="o">.</span><span class="n">identical</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">check_types</span><span class="p">,</span> <span class="n">check_shapes</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">partial</span><span class="p">,</span>
                                   <span class="n">key_chain</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.assert_identical_structure"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.assert_identical_structure">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">assert_identical_structure</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">check_types</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assert whether the input containers have identical structure. Otherwise, the diff is shown in an exception.</span>

<span class="sd">        :param containers: containers to check.</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        :param check_types: Whether to also check whether the datatypes of the leaf nodes are the same. Default is True.</span>
<span class="sd">        :type check_types: bool, optional</span>
<span class="sd">        :param check_shapes: Whether to also check whether the shapes of the leaf nodes are the same. Default is True.</span>
<span class="sd">        :type check_shapes: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param partial: Whether to also check for partially complete sub-containers. Default is False.</span>
<span class="sd">        :type partial: bool, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">Container</span><span class="o">.</span><span class="n">identical_structure</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">check_types</span><span class="p">,</span> <span class="n">check_shapes</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">partial</span><span class="p">),</span>\
            <span class="s1">&#39;Containers did not have identical structure:</span><span class="se">\n\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Container</span><span class="o">.</span><span class="n">structural_diff</span><span class="p">(</span><span class="o">*</span><span class="n">containers</span><span class="p">))</span></div>

<div class="viewcode-block" id="Container.identical_configs"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.identical_configs">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">identical_configs</span><span class="p">(</span><span class="n">containers</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a single boolean as to whether the input containers all have identical configs.</span>

<span class="sd">        :param containers: containers to check.</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">containers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
        <span class="n">configs</span> <span class="o">=</span> <span class="p">[</span><span class="n">cont</span><span class="o">.</span><span class="n">config</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
        <span class="n">config0</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">config0</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">min</span><span class="p">([</span><span class="n">config</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span> <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">]):</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Container.identical_array_shapes"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.identical_array_shapes">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">identical_array_shapes</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">exclusive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine whether all of the containers have identical number of arrays and identical array shapes,</span>
<span class="sd">        regardless of their key-chain structures.</span>

<span class="sd">        :param containers: containers to check.</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        :param exclusive: Whether to check if the data type is exclusively an array, rather than a variable</span>
<span class="sd">                          or traced array.</span>
<span class="sd">        :type exclusive: bool, optional</span>
<span class="sd">        :return: Boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">array_conts</span> <span class="o">=</span> <span class="p">[</span><span class="n">cont</span><span class="o">.</span><span class="n">size_ordered_arrays</span><span class="p">(</span><span class="n">exclusive</span><span class="p">)</span> <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">]</span>
        <span class="n">array_cont0</span> <span class="o">=</span> <span class="n">array_conts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">array_cont0_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">array_cont0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">array_cont</span> <span class="ow">in</span> <span class="n">array_conts</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">array_cont</span><span class="p">)</span> <span class="o">!=</span> <span class="n">array_cont0_len</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">min</span><span class="p">([</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">a0</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">a0</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">array_cont</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">array_cont0</span><span class="o">.</span><span class="n">values</span><span class="p">())]):</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Container.from_disk_as_hdf5"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.from_disk_as_hdf5">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_disk_as_hdf5</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">,</span> <span class="n">slice_obj</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="n">alphabetical_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ivyh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load container object from disk, as an h5py file, at the specified hdf5 filepath.</span>

<span class="sd">        :param h5_obj_or_filepath: Filepath where the container object is saved to disk, or h5 object.</span>
<span class="sd">        :type h5_obj_or_filepath: str or h5 obj</span>
<span class="sd">        :param slice_obj: slice object to slice all h5 elements.</span>
<span class="sd">        :type slice_obj: slice or sequence of slices</span>
<span class="sd">        :param alphabetical_keys: Whether to sort the container keys alphabetically, or preserve the dict order.</span>
<span class="sd">                                  Default is True.</span>
<span class="sd">        :type alphabetical_keys: bool, optional</span>
<span class="sd">        :param ivyh: Handle to ivy module to use for the calculations. Default is None, which results in the global ivy.</span>
<span class="sd">        :type ivyh: handle to ivy module, optional</span>
<span class="sd">        :return: Container loaded from disk</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">_h5py</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s1">&#39;You must install python package h5py in order to load hdf5 files from disk into a container.&#39;</span><span class="p">)</span>
        <span class="n">container_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">_h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">h5_obj_or_filepath</span>
        <span class="n">items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">h5_obj</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="k">if</span> <span class="n">alphabetical_keys</span> <span class="k">else</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">_h5py</span><span class="o">.</span><span class="n">Group</span><span class="p">):</span>
                <span class="n">container_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">from_disk_as_hdf5</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">slice_obj</span><span class="p">,</span> <span class="n">ivyh</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">_h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
                <span class="n">container_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">ivyh</span><span class="p">,</span> <span class="n">ivy</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="n">slice_obj</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Item found inside h5_obj which was neither a Group nor a Dataset.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">container_dict</span><span class="p">,</span> <span class="n">ivyh</span><span class="o">=</span><span class="n">ivyh</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.from_disk_as_pickled"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.from_disk_as_pickled">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_disk_as_pickled</span><span class="p">(</span><span class="n">pickle_filepath</span><span class="p">,</span> <span class="n">ivyh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load container object from disk at the specified pickle filepath.</span>

<span class="sd">        :param pickle_filepath: Filepath where the container object is saved to disk.</span>
<span class="sd">        :type pickle_filepath: str</span>
<span class="sd">        :param ivyh: Handle to ivy module to use for the calculations. Default is None, which results in the global ivy.</span>
<span class="sd">        :type ivyh: handle to ivy module, optional</span>
<span class="sd">        :return: Container loaded from disk</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">_pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">pickle_filepath</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)),</span>
                         <span class="n">rebuild_child_containers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ivyh</span><span class="o">=</span><span class="n">ivyh</span><span class="p">)</span><span class="o">.</span><span class="n">to_ivy</span><span class="p">()</span></div>

<div class="viewcode-block" id="Container.from_disk_as_json"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.from_disk_as_json">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_disk_as_json</span><span class="p">(</span><span class="n">json_filepath</span><span class="p">,</span> <span class="n">ivyh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load container object from disk at the specified json filepath.</span>
<span class="sd">        If some objects were not json-able during saving, then they will be loaded as strings.</span>

<span class="sd">        :param json_filepath: Filepath where the container object is saved to disk.</span>
<span class="sd">        :type json_filepath: str</span>
<span class="sd">        :param ivyh: Handle to ivy module to use for the calculations. Default is None, which results in the global ivy.</span>
<span class="sd">        :type ivyh: handle to ivy module, optional</span>
<span class="sd">        :return: Container loaded from disk</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_data_file</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">_json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_data_file</span><span class="p">),</span> <span class="n">ivyh</span><span class="o">=</span><span class="n">ivyh</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.h5_file_size"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.h5_file_size">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">h5_file_size</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get file size of h5 file contents.</span>

<span class="sd">        :param h5_obj_or_filepath: Filepath where the container object is saved to disk, or h5 object.</span>
<span class="sd">        :type h5_obj_or_filepath: str or h5 obj</span>
<span class="sd">        :return: Size of h5 file contents, and batch size.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">_h5py</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;You must install python package h5py in order to determine the size of hdf5 files.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">_h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">h5_obj_or_filepath</span>

        <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">_h5py</span><span class="o">.</span><span class="n">Group</span><span class="p">):</span>
                <span class="n">size_to_add</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">h5_file_size</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="n">size</span> <span class="o">+=</span> <span class="n">size_to_add</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">_h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
                <span class="n">value_shape</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span>
                <span class="n">size</span> <span class="o">+=</span> <span class="n">_reduce</span><span class="p">(</span><span class="n">_mul</span><span class="p">,</span> <span class="n">value_shape</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">value</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span>
                <span class="n">batch_size</span> <span class="o">=</span> <span class="n">value_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Item found inside h5_obj which was neither a Group nor a Dataset.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">size</span><span class="p">,</span> <span class="n">batch_size</span></div>

<div class="viewcode-block" id="Container.shuffle_h5_file"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.shuffle_h5_file">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">shuffle_h5_file</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">,</span> <span class="n">seed_value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shuffle entries in all datasets of h5 file, such that they are still aligned along axis 0.</span>

<span class="sd">        :param h5_obj_or_filepath: Filepath where the container object is saved to disk, or h5 object.</span>
<span class="sd">        :type h5_obj_or_filepath: str or h5 obj</span>
<span class="sd">        :param seed_value: random seed to use for array shuffling</span>
<span class="sd">        :type seed_value: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">_h5py</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;You must install python package h5py in order to shuffle hdf5 files on disk.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">seed_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">seed_value</span> <span class="o">=</span> <span class="n">_random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">_h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">h5_obj_or_filepath</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">_h5py</span><span class="o">.</span><span class="n">Group</span><span class="p">):</span>
                <span class="n">Container</span><span class="o">.</span><span class="n">shuffle_h5_file</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">seed_value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">_h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
                <span class="n">_random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
                <span class="c1"># noinspection PyTypeChecker</span>
                <span class="n">_random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Item found inside h5_obj which was neither a Group nor a Dataset.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">h5_obj</span><span class="p">,</span> <span class="n">_h5py</span><span class="o">.</span><span class="n">File</span><span class="p">):</span>
            <span class="n">h5_obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Container.reduce"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.reduce">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">reduce</span><span class="p">(</span><span class="n">containers</span><span class="p">,</span> <span class="n">reduction</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reduce containers.</span>

<span class="sd">        :param containers: containers to reduce</span>
<span class="sd">        :type containers: sequence of Container objects</span>
<span class="sd">        :param reduction: the reduction function</span>
<span class="sd">        :type reduction: callable with single list input x</span>
<span class="sd">        :param config: The configuration for the containers. Default is the same as container0.</span>
<span class="sd">        :type config: dict, optional</span>
<span class="sd">        :return: reduced containers</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">container0</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">container0</span><span class="o">.</span><span class="n">config</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container0</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">container0</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="n">container</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">],</span> <span class="n">reduction</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># noinspection PyBroadException</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">reduction</span><span class="p">(</span><span class="n">containers</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Container reduce operation only valid for containers of arrays&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.flatten_key_chain"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.flatten_key_chain">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">flatten_key_chain</span><span class="p">(</span><span class="n">key_chain</span><span class="p">,</span> <span class="n">replacement</span><span class="o">=</span><span class="s1">&#39;__&#39;</span><span class="p">,</span> <span class="n">above_height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">below_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># noinspection RegExpSingleCharAlternation</span>
        <span class="n">flat_keys</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/|\.&#39;</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">)</span>
        <span class="n">num_keys</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">flat_keys</span><span class="p">)</span>
        <span class="n">pre_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">post_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">above_height</span> <span class="ow">and</span> <span class="n">num_keys</span> <span class="o">&gt;</span> <span class="n">above_height</span><span class="p">:</span>
            <span class="n">post_keys</span> <span class="o">=</span> <span class="n">flat_keys</span><span class="p">[</span><span class="o">-</span><span class="n">above_height</span><span class="p">:]</span>
            <span class="k">del</span> <span class="n">flat_keys</span><span class="p">[</span><span class="o">-</span><span class="n">above_height</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">below_depth</span> <span class="ow">and</span> <span class="n">num_keys</span> <span class="o">&gt;</span> <span class="n">below_depth</span><span class="p">:</span>
            <span class="n">pre_keys</span> <span class="o">=</span> <span class="n">flat_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">below_depth</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">flat_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">below_depth</span><span class="p">]</span>
        <span class="k">return</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pre_keys</span><span class="p">),</span> <span class="n">replacement</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flat_keys</span><span class="p">),</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">post_keys</span><span class="p">)]</span> <span class="k">if</span> <span class="n">k</span><span class="p">])</span></div>

<div class="viewcode-block" id="Container.trim_key"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.trim_key">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">trim_key</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">max_length</span><span class="p">):</span>
        <span class="n">key_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">max_length</span><span class="p">)</span> <span class="ow">or</span> <span class="n">key_len</span> <span class="o">&lt;=</span> <span class="n">max_length</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">key</span>
        <span class="n">idxs</span> <span class="o">=</span>\
            <span class="n">_np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">key_len</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">max_length</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">_np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_length</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_length</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">key</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">])</span></div>

    <span class="c1"># Private Methods #</span>
    <span class="c1"># ----------------#</span>

    <span class="k">def</span> <span class="nf">_get_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queues</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_queue_load_sizes_cum</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">return</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sub_shapes</span> <span class="o">=</span>\
            <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">MultiDev</span><span class="p">))</span> <span class="k">else</span> <span class="kc">None</span><span class="p">))</span><span class="o">.</span><span class="n">to_iterator</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_shapes</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sub_shapes</span>
        <span class="n">min_num_dims</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">sub_shape</span> <span class="ow">in</span> <span class="n">sub_shapes</span><span class="p">])</span>
        <span class="n">sub_shapes_array</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">sub_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">min_num_dims</span><span class="p">]</span> <span class="k">for</span> <span class="n">sub_shape</span> <span class="ow">in</span> <span class="n">sub_shapes</span><span class="p">])</span>
        <span class="n">sub_shapes_array</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sub_shapes_array</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">sub_shapes_array</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">sub_shapes_array</span> <span class="o">/</span> <span class="n">sub_shapes_array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="c1"># noinspection PyTypeChecker</span>
        <span class="k">return</span> <span class="p">[</span><span class="kc">None</span> <span class="k">if</span> <span class="n">_np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">_np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">sub_shapes_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">_np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">min_num_dims</span><span class="p">)</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>

    <span class="k">def</span> <span class="nf">_get_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;shape&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_dev</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">as_str</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">sub_devs</span> <span class="o">=</span>\
            <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">dev</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">as_str</span><span class="o">=</span><span class="n">as_str</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">to_iterator</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">sub_devs</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sub_devs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_at_key_chains_input_as_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">return_cont</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="nb">dict</span><span class="p">(),</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">kc</span> <span class="ow">in</span> <span class="n">key_chains</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">at_key_chain</span><span class="p">(</span><span class="n">kc</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="n">ignore_key_errors</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ignore_key_errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">return_cont</span><span class="o">.</span><span class="n">set_at_key_chain</span><span class="p">(</span><span class="n">kc</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">return_cont</span>

    <span class="k">def</span> <span class="nf">_at_key_chains_input_as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">current_chain</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">key_chains</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">current_chain</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">new_current_chain</span> <span class="o">=</span> <span class="n">k</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_current_chain</span> <span class="o">=</span> <span class="n">current_chain</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">k</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_at_key_chains_input_as_dict</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">new_current_chain</span><span class="p">,</span>
                                                                   <span class="n">ignore_key_errors</span><span class="o">=</span><span class="n">ignore_key_errors</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">at_key_chain</span><span class="p">(</span><span class="n">new_current_chain</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="n">ignore_key_errors</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ignore_key_errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_prune_key_chains_input_as_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">):</span>
        <span class="n">return_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">kc</span> <span class="ow">in</span> <span class="n">key_chains</span><span class="p">:</span>
            <span class="n">return_cont</span> <span class="o">=</span> <span class="n">return_cont</span><span class="o">.</span><span class="n">prune_key_chain</span><span class="p">(</span><span class="n">kc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">return_cont</span>

    <span class="k">def</span> <span class="nf">_prune_key_chains_input_as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">return_cont</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">return_cont</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">return_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">key_chains</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">ret_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prune_key_chains_input_as_dict</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">return_cont</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">ret_cont</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">return_cont</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">return_cont</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">return_cont</span>

    <span class="c1"># Public Methods #</span>
    <span class="c1"># ---------------#</span>

<div class="viewcode-block" id="Container.update_config"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.update_config">[docs]</a>    <span class="k">def</span> <span class="nf">update_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">):</span>

        <span class="n">new_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">att_name</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">k</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config_in</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;types_to_iteratively_nest&#39;</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="p">(),</span> <span class="kc">True</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;keyword_color_dict&#39;</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">{})</span>
                <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;ivyh&#39;</span><span class="p">:</span>
                    <span class="n">att_name</span> <span class="o">=</span> <span class="s1">&#39;_local_ivy&#39;</span>
                <span class="n">new_config</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
                <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">att_name</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">new_config</span></div>

<div class="viewcode-block" id="Container.inplace_update"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.inplace_update">[docs]</a>    <span class="k">def</span> <span class="nf">inplace_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dict_in</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the contents of this container inplace, using either a new dict or container.</span>

<span class="sd">        :param dict_in: New dict or container to update the current container inplace with.</span>
<span class="sd">        :type dict_in: container or dict</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># update config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_config</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>

        <span class="c1"># update container values inplace</span>
        <span class="k">if</span> <span class="n">dict_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">dict_types</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">dict</span><span class="p">]</span> <span class="o">+</span> <span class="n">ivy</span><span class="o">.</span><span class="n">container_types</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dict_in</span><span class="p">,</span> <span class="n">dict_types</span><span class="p">):</span>
            <span class="n">dict_in</span> <span class="o">=</span> <span class="n">dict_in</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dict_in</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_types_to_iteratively_nest</span><span class="p">)):</span>
            <span class="n">dict_in</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;it_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dict_in</span><span class="p">)))))</span>
                                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dict_in</span><span class="p">))],</span> <span class="n">dict_in</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;invalid input </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dict_in</span><span class="p">))</span>
        <span class="n">items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dict_in</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alphabetical_keys</span> <span class="k">else</span> <span class="n">dict_in</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dict_types</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span> <span class="ow">or</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">_rebuild_child_containers</span><span class="p">))</span> <span class="ow">or</span> \
                    <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_types_to_iteratively_nest</span><span class="p">)):</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div>

<div class="viewcode-block" id="Container.set_framework"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.set_framework">[docs]</a>    <span class="k">def</span> <span class="nf">set_framework</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ivyh</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the framework to use for the container.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span> <span class="o">=</span> <span class="n">ivyh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s1">&#39;ivyh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivyh</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Container.all_true"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.all_true">[docs]</a>    <span class="k">def</span> <span class="nf">all_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assert_is_bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine whether all the entries in the container boolean evaluate to True.</span>

<span class="sd">        :param assert_is_bool: Whether or not to assert each entry is of type Boolean.</span>
<span class="sd">        :type assert_is_bool: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Boolean, whether all entries are boolean True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">prod</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_bools</span><span class="p">(</span>
            <span class="n">assert_is_bool</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span><span class="o">.</span><span class="n">to_iterator</span><span class="p">()]))</span></div>

<div class="viewcode-block" id="Container.all_false"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.all_false">[docs]</a>    <span class="k">def</span> <span class="nf">all_false</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assert_is_bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine whether all the entries in the container boolean evaluate to False.</span>

<span class="sd">        :param assert_is_bool: Whether or not to assert each entry is of type Boolean.</span>
<span class="sd">        :type assert_is_bool: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Boolean, whether all entries are boolean False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_bools</span><span class="p">(</span>
            <span class="n">assert_is_bool</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span><span class="o">.</span><span class="n">to_iterator</span><span class="p">()]))</span></div>

<div class="viewcode-block" id="Container.sum"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.sum">[docs]</a>    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes sum of array elements along a given axis for all sub-arrays of container object.</span>

<span class="sd">        :param axis: Axis or axes along which a sum is performed. The default, axis=None, will sum all of the elements</span>
<span class="sd">                     of the input array. If axis is negative it counts from the last to the first axis. If axis is a</span>
<span class="sd">                     tuple of ints, a sum is performed on all of the axes specified in the tuple instead of a single</span>
<span class="sd">                     axis or all the axes as before.</span>
<span class="sd">        :type axis: int or sequence of ints</span>
<span class="sd">        :param keepdims: If this is set to True, the axes which are reduced are left in the result as dimensions with</span>
<span class="sd">                         size one. With this option, the result will broadcast correctly against the input array.</span>
<span class="sd">        :type keepdims: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-array dimensions expanded along the axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.prod"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.prod">[docs]</a>    <span class="k">def</span> <span class="nf">prod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes product of array elements along a given axis for all sub-arrays of container object.</span>

<span class="sd">        :param axis: Axis or axes along which a product is performed. The default, axis=None, will multiply all of the</span>
<span class="sd">                     elements of the input array. If axis is negative it counts from the last to the first axis. If axis</span>
<span class="sd">                     is a tuple of ints, a multiplication is performed on all of the axes specified in the tuple instead</span>
<span class="sd">                     of a single axis or all the axes as before.</span>
<span class="sd">        :type axis: int or sequence of ints</span>
<span class="sd">        :param keepdims: If this is set to True, the axes which are reduced are left in the result as dimensions with</span>
<span class="sd">                         size one. With this option, the result will broadcast correctly against the input array.</span>
<span class="sd">        :type keepdims: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-array dimensions expanded along the axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="n">keepdims</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.mean"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.mean">[docs]</a>    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes mean of array elements along a given axis for all sub-arrays of container object.</span>

<span class="sd">        :param axis: Axis or axes along which a mean is performed. The default, axis=None, will mean all of the elements</span>
<span class="sd">                     of the input array. If axis is negative it counts from the last to the first axis. If axis is a</span>
<span class="sd">                     tuple of ints, a mean is performed on all of the axes specified in the tuple instead of a single</span>
<span class="sd">                     axis or all the axes as before.</span>
<span class="sd">        :type axis: int or sequence of ints</span>
<span class="sd">        :param keepdims: If this is set to True, the axes which are reduced are left in the result as dimensions with</span>
<span class="sd">                         size one. With this option, the result will broadcast correctly against the input array.</span>
<span class="sd">        :type keepdims: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-array dimensions expanded along the axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.var"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.var">[docs]</a>    <span class="k">def</span> <span class="nf">var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes variance of array elements along a given axis for all sub-arrays of container object.</span>

<span class="sd">        :param axis: Axis or axes along which a var is performed. The default, axis=None, will var all of the elements</span>
<span class="sd">                     of the input array. If axis is negative it counts from the last to the first axis. If axis is a</span>
<span class="sd">                     tuple of ints, a var is performed on all of the axes specified in the tuple instead of a single</span>
<span class="sd">                     axis or all the axes as before.</span>
<span class="sd">        :type axis: int or sequence of ints</span>
<span class="sd">        :param keepdims: If this is set to True, the axes which are reduced are left in the result as dimensions with</span>
<span class="sd">                         size one. With this option, the result will broadcast correctly against the input array.</span>
<span class="sd">        :type keepdims: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with the variance computed for all sub-arrays.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.std"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.std">[docs]</a>    <span class="k">def</span> <span class="nf">std</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes standard deviation of array elements along a given axis for all sub-arrays of container object.</span>

<span class="sd">        :param axis: Axis or axes along which a var is performed. The default, axis=None, will var all of the elements</span>
<span class="sd">                     of the input array. If axis is negative it counts from the last to the first axis. If axis is a</span>
<span class="sd">                     tuple of ints, a var is performed on all of the axes specified in the tuple instead of a single</span>
<span class="sd">                     axis or all the axes as before.</span>
<span class="sd">        :type axis: int or sequence of ints</span>
<span class="sd">        :param keepdims: If this is set to True, the axes which are reduced are left in the result as dimensions with</span>
<span class="sd">                         size one. With this option, the result will broadcast correctly against the input array.</span>
<span class="sd">        :type keepdims: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with the standard deviation computed for all sub-arrays.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="n">keepdims</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.reduce_min"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.reduce_min">[docs]</a>    <span class="k">def</span> <span class="nf">reduce_min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes min of array elements along a given axis for all sub-arrays of container object.</span>

<span class="sd">        :param axis: Axis or axes along which a min is performed. The default, axis=None, will min all of the elements</span>
<span class="sd">                     of the input array. If axis is negative it counts from the last to the first axis. If axis is a</span>
<span class="sd">                     tuple of ints, a min is performed on all of the axes specified in the tuple instead of a single</span>
<span class="sd">                     axis or all the axes as before.</span>
<span class="sd">        :type axis: int or sequence of ints</span>
<span class="sd">        :param keepdims: If this is set to True, the axes which are reduced are left in the result as dimensions with</span>
<span class="sd">                         size one. With this option, the result will broadcast correctly against the input array.</span>
<span class="sd">        :type keepdims: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-array dimensions expanded along the axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">reduce_min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.reduce_max"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.reduce_max">[docs]</a>    <span class="k">def</span> <span class="nf">reduce_max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes max of array elements along a given axis for all sub-arrays of container object.</span>

<span class="sd">        :param axis: Axis or axes along which a max is performed. The default, axis=None, will max all of the elements</span>
<span class="sd">                     of the input array. If axis is negative it counts from the last to the first axis. If axis is a</span>
<span class="sd">                     tuple of ints, a max is performed on all of the axes specified in the tuple instead of a single</span>
<span class="sd">                     axis or all the axes as before.</span>
<span class="sd">        :type axis: int or sequence of ints</span>
<span class="sd">        :param keepdims: If this is set to True, the axes which are reduced are left in the result as dimensions with</span>
<span class="sd">                         size one. With this option, the result will broadcast correctly against the input array.</span>
<span class="sd">        :type keepdims: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-array dimensions expanded along the axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">reduce_max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.minimum"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.minimum">[docs]</a>    <span class="k">def</span> <span class="nf">minimum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the elementwise minimum between this container and another container or number.</span>

<span class="sd">        :param other: The other container or number to compute the minimum against.</span>
<span class="sd">        :type other: Ivy container or number</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-arrays having the minimum values computed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">is_container</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="n">kc</span><span class="p">]</span> <span class="k">if</span> <span class="n">is_container</span> <span class="k">else</span> <span class="n">other</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.maximum"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.maximum">[docs]</a>    <span class="k">def</span> <span class="nf">maximum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the elementwise maximum between this container and another container or number.</span>

<span class="sd">        :param other: The other container or number to compute the maximum against.</span>
<span class="sd">        :type other: Ivy container or number</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-arrays having the maximum values computed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">is_container</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="n">kc</span><span class="p">]</span> <span class="k">if</span> <span class="n">is_container</span> <span class="k">else</span> <span class="n">other</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.clip"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.clip">[docs]</a>    <span class="k">def</span> <span class="nf">clip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clip_min</span><span class="p">,</span> <span class="n">clip_max</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the elementwise clipped values between this container and clip_min and clip_max containers or numbers.</span>

<span class="sd">        :param clip_min: The minimum container or number to clip against.</span>
<span class="sd">        :type clip_min: Ivy container or number</span>
<span class="sd">        :param clip_max: The maximum container or number to clip against.</span>
<span class="sd">        :type clip_max: Ivy container or number</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-arrays having the clipped values returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">min_is_container</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clip_min</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span>
        <span class="n">max_is_container</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clip_max</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">clip_min</span><span class="p">[</span><span class="n">kc</span><span class="p">]</span> <span class="k">if</span> <span class="n">min_is_container</span> <span class="k">else</span> <span class="n">clip_min</span><span class="p">,</span>
                                       <span class="n">clip_max</span><span class="p">[</span><span class="n">kc</span><span class="p">]</span> <span class="k">if</span> <span class="n">max_is_container</span> <span class="k">else</span> <span class="n">clip_max</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.clip_vector_norm"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.clip_vector_norm">[docs]</a>    <span class="k">def</span> <span class="nf">clip_vector_norm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_norm</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">global_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the elementwise clipped values between this container and clip_min and clip_max containers or numbers.</span>

<span class="sd">        :param max_norm: The max norm container or number to clip against.</span>
<span class="sd">        :type max_norm: Ivy container or number</span>
<span class="sd">        :param p: The p-value for computing the p-norm container or number.</span>
<span class="sd">        :type p: Ivy container or number</span>
<span class="sd">        :param global_norm: Whether to compute the norm across all the concattenated sub-arrays. Default is False.</span>
<span class="sd">        :type global_norm: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-arrays having the clipped norms returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">max_norm_is_container</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">max_norm</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span>
        <span class="n">p_is_container</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">global_norm</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">max_norm_is_container</span> <span class="ow">or</span> <span class="n">p_is_container</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s1">&#39;global_norm can only be computed for scalar max_norm and p_val arguments,&#39;</span>
                    <span class="s1">&#39;but found </span><span class="si">{}</span><span class="s1"> and </span><span class="si">{}</span><span class="s1"> of type </span><span class="si">{}</span><span class="s1"> and </span><span class="si">{}</span><span class="s1"> respectively&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">max_norm</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">max_norm</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">)))</span>
            <span class="n">vector_norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_norm</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">global_norm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">ratio</span> <span class="o">=</span> <span class="n">max_norm</span><span class="o">/</span><span class="n">vector_norm</span>
            <span class="k">if</span> <span class="n">ratio</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span> <span class="o">*</span> <span class="n">ratio</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">clip_vector_norm</span><span class="p">(</span>
                            <span class="n">x</span><span class="p">,</span> <span class="n">max_norm</span><span class="p">[</span><span class="n">kc</span><span class="p">]</span> <span class="k">if</span> <span class="n">max_norm_is_container</span> <span class="k">else</span> <span class="n">max_norm</span><span class="p">,</span>
                            <span class="n">p</span><span class="p">[</span><span class="n">kc</span><span class="p">]</span> <span class="k">if</span> <span class="n">p_is_container</span> <span class="k">else</span> <span class="n">p</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.einsum"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.einsum">[docs]</a>    <span class="k">def</span> <span class="nf">einsum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">equation</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sums the product of the elements of the input operands along dimensions specified using a notation based on the</span>
<span class="sd">        Einstein summation convention, for each array in the container.</span>

<span class="sd">        :param equation: A str describing the contraction, in the same format as numpy.einsum.</span>
<span class="sd">        :type equation: str</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-array dimensions expanded along the axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="n">equation</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.vector_norm"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.vector_norm">[docs]</a>    <span class="k">def</span> <span class="nf">vector_norm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">global_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute vector p-norm for each array in the container.</span>

<span class="sd">        :param p: Order of the norm. Default is 2.</span>
<span class="sd">        :type p: int or str or container, optional</span>
<span class="sd">        :param axis: If axis is an integer, it specifies the axis of x along which to compute the vector norms.</span>
<span class="sd">                     Default is None, in which case the flattened array is considered.</span>
<span class="sd">        :type axis: int or sequence of ints, optional</span>
<span class="sd">        :param keepdims: If this is set to True, the axes which are normed over are left in the result as dimensions</span>
<span class="sd">                         with size one. With this option the result will broadcast correctly against the original x.</span>
<span class="sd">                         Default is False.</span>
<span class="sd">        :type keepdims: bool, optional</span>
<span class="sd">        :param global_norm: Whether to compute the norm across all the concattenated sub-arrays. Default is False.</span>
<span class="sd">        :type global_norm: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with the vector norms for each sub-array returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">p_is_container</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">global_norm</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">p_is_container</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s1">&#39;global_norm can only be computed for scalar p argument,&#39;</span>
                    <span class="s1">&#39;but found </span><span class="si">{}</span><span class="s1"> of type </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">)))</span>
            <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="n">p</span><span class="p">))</span><span class="o">.</span><span class="n">to_iterator</span><span class="p">()])</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">vector_norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="n">kc</span><span class="p">]</span> <span class="k">if</span> <span class="n">p_is_container</span> <span class="k">else</span> <span class="n">p</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.matrix_norm"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.matrix_norm">[docs]</a>    <span class="k">def</span> <span class="nf">matrix_norm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute matrix p-norm for each array in the container.</span>

<span class="sd">        :param p: Order of the norm. Default is 2.</span>
<span class="sd">        :type p: int or str, optional</span>
<span class="sd">        :param axis: If axis is an integer, it specifies the axis of x along which to compute the matrix norms.</span>
<span class="sd">                     Default is None, in which case the flattened array is considered.</span>
<span class="sd">        :type axis: int or sequence of ints, optional</span>
<span class="sd">        :param keepdims: If this is set to True, the axes which are normed over are left in the result as dimensions</span>
<span class="sd">                         with size one. With this option the result will broadcast correctly against the original x.</span>
<span class="sd">                         Default is False.</span>
<span class="sd">        :type keepdims: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with the matrix norms for each sub-array returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">matrix_norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.flip"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.flip">[docs]</a>    <span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reverses the order of elements in for each array in the container, along the given axis.</span>
<span class="sd">        The shape of the array is preserved, but the elements are reordered.</span>

<span class="sd">        :param axis: Axis or axes along which to flip over. The default, axis=None, will flip over all axes.</span>
<span class="sd">        :type axis: None or int or sequence of ints, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-array dimensions expanded along the axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.shuffle"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.shuffle">[docs]</a>    <span class="k">def</span> <span class="nf">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">key_chain</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shuffle entries in all sub-arrays, such that they are still aligned along axis 0.</span>

<span class="sd">        :param seed_value: random seed to use for array shuffling</span>
<span class="sd">        :type seed_value: int</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :param key_chain: Chain of keys for this dict entry</span>
<span class="sd">        :type key_chain: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">seed_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">seed_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="p">()))</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">this_key_chain</span> <span class="o">=</span> <span class="n">key</span> <span class="k">if</span> <span class="n">key_chain</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="p">(</span><span class="n">key_chain</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">seed_value</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">,</span> <span class="n">this_key_chain</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="n">map_sequences</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">_shuffle</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">nested_map</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">_shuffle</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key_chains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">this_key_chain</span> <span class="ow">in</span> <span class="n">key_chains</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">to_apply</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                            <span class="n">this_key_chain</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key_chains</span> <span class="ow">and</span> <span class="n">to_apply</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">prune_unapplied</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                        <span class="k">continue</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.slice_via_key"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.slice_via_key">[docs]</a>    <span class="k">def</span> <span class="nf">slice_via_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slice_key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get slice of container, based on key.</span>

<span class="sd">        :param slice_key: key to slice container at.</span>
<span class="sd">        :type slice_key: str</span>
<span class="sd">        :return: Container object sliced at desired key.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">slice_key</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">value</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">slice_via_key</span><span class="p">(</span><span class="n">slice_key</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.as_ones"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.as_ones">[docs]</a>    <span class="k">def</span> <span class="nf">as_ones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return arrays of ones for all nested arrays in the container.</span>

<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-arrays filled with ones.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span>
                        <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.as_zeros"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.as_zeros">[docs]</a>    <span class="k">def</span> <span class="nf">as_zeros</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return arrays of zeros for all nested arrays in the container.</span>

<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-arrays filled with zeros.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span>
                        <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.as_bools"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.as_bools">[docs]</a>    <span class="k">def</span> <span class="nf">as_bools</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assert_is_bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return boolean evaluation for all nested items in the container.</span>

<span class="sd">        :param assert_is_bool: Whether or not to assert the entry is of type Boolean.</span>
<span class="sd">        :type assert_is_bool: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all entries boolean evaluated.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_ret_bool</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">assert_is_bool</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">x</span>
            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">_ret_bool</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.as_random_uniform"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.as_random_uniform">[docs]</a>    <span class="k">def</span> <span class="nf">as_random_uniform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return arrays of random uniform values for all nested arrays in the container.</span>

<span class="sd">        :param low: Lower boundary of the output interval. All values generated will be greater than or equal to low.</span>
<span class="sd">                    The default value is 0.</span>
<span class="sd">        :type low: float</span>
<span class="sd">        :param high: Upper boundary of the output interval. All values generated will be less than high.</span>
<span class="sd">                    The default value is 1.0.</span>
<span class="sd">        :type high: float</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-arrays filled with random uniform values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span>
            <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">dev</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.to_native"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_native">[docs]</a>    <span class="k">def</span> <span class="nf">to_native</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nested</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return native framework arrays for all nested arrays in the container.</span>

<span class="sd">        :param nested: Whether to apply the conversion on arguments in a nested manner. If so, all dicts, lists and</span>
<span class="sd">                       tuples will be traversed to their lowest leaves in search of ivy.Array and ivy.Variable</span>
<span class="sd">                       instances. Default is False.</span>
<span class="sd">        :type nested: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-arrays converted to their native format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">to_native</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">nested</span><span class="o">=</span><span class="n">nested</span><span class="p">),</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span>
                        <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.to_ivy"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_ivy">[docs]</a>    <span class="k">def</span> <span class="nf">to_ivy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nested</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return ivy arrays for all nested native framework arrays in the container.</span>

<span class="sd">        :param nested: Whether to apply the conversion on arguments in a nested manner. If so, all dicts, lists and</span>
<span class="sd">                       tuples will be traversed to their lowest leaves in search of ivy.Array and ivy.Variable</span>
<span class="sd">                       instances. Default is False.</span>
<span class="sd">        :type nested: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all native sub-arrays converted to their ivy.Array instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">to_ivy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">nested</span><span class="o">=</span><span class="n">nested</span><span class="p">),</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span>
                        <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.expand_dims"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.expand_dims">[docs]</a>    <span class="k">def</span> <span class="nf">expand_dims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Expand dims of all sub-arrays of container object.</span>

<span class="sd">        :param axis: Axis along which to expand dimensions of the sub-arrays.</span>
<span class="sd">        :type axis: int</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-array dimensions expanded along the axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.dev_clone"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.dev_clone">[docs]</a>    <span class="k">def</span> <span class="nf">dev_clone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">devs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clone the current container across multiple devices.</span>

<span class="sd">        :param devs: The devices on which to clone the container.</span>
<span class="sd">        :type devs: sequence of str</span>
<span class="sd">        :return: a set of cloned containers across the specified devices.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">DevClonedItem</span><span class="p">({</span><span class="n">dev</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dev</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span> <span class="k">for</span> <span class="n">dev</span> <span class="ow">in</span> <span class="n">devs</span><span class="p">})</span></div>

<div class="viewcode-block" id="Container.dev_dist"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.dev_dist">[docs]</a>    <span class="k">def</span> <span class="nf">dev_dist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">devs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Distribute the current container across multiple devices.</span>

<span class="sd">        :param devs: The devices along which to distribute the container.</span>
<span class="sd">        :type devs: sequence of strs or dict of split sizes</span>
<span class="sd">        :param axis: The axis along which to split the arrays at the container leaves. Default is 0.</span>
<span class="sd">        :type axis: int, optional</span>
<span class="sd">        :return: a set of distributed sub-containers across the specified devices.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">split_arg</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">devs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">devs</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">devs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">DevDistItem</span><span class="p">(</span>
            <span class="p">{</span><span class="n">dev</span><span class="p">:</span> <span class="n">cont</span><span class="o">.</span><span class="n">to_dev</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span> <span class="k">for</span> <span class="n">cont</span><span class="p">,</span> <span class="n">dev</span> <span class="ow">in</span>
             <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">split_arg</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">with_remainder</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">devs</span><span class="p">)})</span></div>

<div class="viewcode-block" id="Container.to_multi_dev"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_multi_dev">[docs]</a>    <span class="k">def</span> <span class="nf">to_multi_dev</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">devs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a single MultiDevContainer, which shares the same structure as the current container, but replaces arrays</span>
<span class="sd">        at the leaves with DistributedArray instances.</span>

<span class="sd">        :param devs: The devices along which to distribute each array in the container.</span>
<span class="sd">        :type devs: sequence of str</span>
<span class="sd">        :param axis: The axis along which to split the arrays at the container leaves. Default is 0.</span>
<span class="sd">        :type axis: int, optional</span>
<span class="sd">        :return: a MultiDevContainer instance, with all leafs arrays replaced by DistributedArray instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">MultiDevContainer</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">dev_dist_array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">devs</span><span class="p">,</span> <span class="n">axis</span><span class="p">)),</span> <span class="n">devs</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.unstack"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.unstack">[docs]</a>    <span class="k">def</span> <span class="nf">unstack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dim_size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unstack containers along specified dimension.</span>

<span class="sd">        :param axis: Dimensions along which to unstack.</span>
<span class="sd">        :type axis: int</span>
<span class="sd">        :param keepdims: Whether to keep dimension 1 in the unstack dimensions. Default is False.</span>
<span class="sd">        :type keepdims: bool, optional</span>
<span class="sd">        :param dim_size: Size of the dimension to unstack. Determined from inputs by default.</span>
<span class="sd">        :type dim_size: int, optional</span>
<span class="sd">        :return: List of containers, unstacked along the specified dimension.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dim_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dim_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">keepdims</span><span class="p">:</span>
            <span class="c1"># noinspection PyTypeChecker</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span>
                         <span class="k">else</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span> <span class="o">*</span> <span class="n">axis</span> <span class="o">+</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim_size</span><span class="p">)]</span>
        <span class="c1"># noinspection PyTypeChecker</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span> <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span> <span class="o">*</span> <span class="n">axis</span> <span class="o">+</span> <span class="p">[</span><span class="n">i</span><span class="p">])]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim_size</span><span class="p">)]</span></div>

<div class="viewcode-block" id="Container.split"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.split">[docs]</a>    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_or_size_splits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">with_remainder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Splits a container into multiple sub-containers, by splitting their constituent arrays.</span>

<span class="sd">        :param num_or_size_splits: Number of equal arrays to divide the array into along the given axis if an integer.</span>
<span class="sd">                                   The size of each split element if a sequence of integers.</span>
<span class="sd">                                   Default is to divide into as many 1-dimensional arrays as the axis dimension.</span>
<span class="sd">        :type num_or_size_splits: int, optional</span>
<span class="sd">        :param axis: The axis along which to split, default is 0.</span>
<span class="sd">        :type axis: int, optional</span>
<span class="sd">        :param with_remainder: If the tensor does not split evenly, then store the last remainder entry.</span>
<span class="sd">                               Default is False.</span>
<span class="sd">        :type with_remainder: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: A list of sub-arrays.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dim_size</span> <span class="o">=</span> <span class="n">num_or_size_splits</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_or_size_splits</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">num_or_size_splits</span><span class="p">)</span>
        <span class="c1"># noinspection PyTypeChecker</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">num_or_size_splits</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">with_remainder</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">x</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim_size</span><span class="o">=</span><span class="n">dim_size</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.gather"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.gather">[docs]</a>    <span class="k">def</span> <span class="nf">gather</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gather slices from all container params at axis according to indices.</span>

<span class="sd">        :param indices: Index array.</span>
<span class="sd">        :type indices: array</span>
<span class="sd">        :param axis: The axis from which to gather from. Default is -1.</span>
<span class="sd">        :type axis: int, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-array dimensions gathered along the axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.gather_nd"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.gather_nd">[docs]</a>    <span class="k">def</span> <span class="nf">gather_nd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gather slices from all container params into a arrays with shape specified by indices.</span>

<span class="sd">        :param indices: Index array.</span>
<span class="sd">        :type indices: array</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: Container object with all sub-array dimensions gathered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.repeat"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.repeat">[docs]</a>    <span class="k">def</span> <span class="nf">repeat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repeats</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Repeat values along a given dimension for each array in the container.</span>

<span class="sd">        :param repeats: Number of repetitions for each element. repeats is broadcast to fit the shape of the given axis.</span>
<span class="sd">        :type repeats: int or sequence of ints.</span>
<span class="sd">        :param axis: The axis along which to repeat values.</span>
<span class="sd">                      By default, use the flattened input array, and return a flat output array.</span>
<span class="sd">        :type axis: int, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: container with each array being repeated along the specified dimension.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">repeats</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.swapaxes"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.swapaxes">[docs]</a>    <span class="k">def</span> <span class="nf">swapaxes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis0</span><span class="p">,</span> <span class="n">axis1</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Interchange two axes for each array in the container.</span>

<span class="sd">        :param axis0: First axis to be swapped.</span>
<span class="sd">        :type axis0: int</span>
<span class="sd">        :param axis1: Second axis to be swapped.</span>
<span class="sd">        :type axis1: int</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: ivy.Container with each chosen array having the axes swapped.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis0</span><span class="p">,</span> <span class="n">axis1</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.reshape"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.reshape">[docs]</a>    <span class="k">def</span> <span class="nf">reshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pre_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shape_slice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">post_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reshapes each array x in the container, to a new shape given by pre_shape + x.shape[shape_slice] + post_shape.</span>
<span class="sd">        If shape_slice or post_shape are not specified, then the term is ignored.</span>

<span class="sd">        :param pre_shape: The first elements in the new array shape.</span>
<span class="sd">        :type pre_shape: int or sequence of ints, optional</span>
<span class="sd">        :param shape_slice: The slice of the original shape to use in the new shape. Default is None.</span>
<span class="sd">        :type shape_slice: int or sequence of ints, optional</span>
<span class="sd">        :param post_shape: The final elements in the new array shape. Default is None.</span>
<span class="sd">        :type post_shape: sequence of ints, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: ivy.Container with each array reshaped as specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pre_shape</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">pre_shape</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span>\
            <span class="p">([</span><span class="n">pre_shape</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pre_shape</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">pre_shape</span><span class="p">))</span>
        <span class="n">post_shape</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">post_shape</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span>\
            <span class="p">([</span><span class="n">post_shape</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">post_shape</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">post_shape</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">shape_slice</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pre_shape</span> <span class="o">+</span> <span class="n">post_shape</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                            <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span>
        <span class="n">shape_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">shape_slice</span><span class="p">,</span> <span class="n">shape_slice</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape_slice</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">shape_slice</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pre_shape</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">shape_slice</span><span class="p">])</span> <span class="o">+</span> <span class="n">post_shape</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.einops_rearrange"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.einops_rearrange">[docs]</a>    <span class="k">def</span> <span class="nf">einops_rearrange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span>  <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="o">**</span><span class="n">axes_lengths</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform einops rearrange operation on each sub array in the container.</span>

<span class="sd">        :param pattern: Rearrangement pattern.</span>
<span class="sd">        :type pattern: str</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :param axes_lengths: Any additional specifications for dimensions.</span>
<span class="sd">        :type axes_lengths: keyword parameter args</span>
<span class="sd">        :return: ivy.Container with each array having einops.rearrange applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">ivy</span><span class="o">.</span><span class="n">einops_rearrange</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="o">**</span><span class="n">axes_lengths</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.einops_reduce"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.einops_reduce">[docs]</a>    <span class="k">def</span> <span class="nf">einops_reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span>  <span class="n">reduction</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">axes_lengths</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform einops reduce operation on each sub array in the container.</span>

<span class="sd">        :param pattern: Reduction pattern.</span>
<span class="sd">        :type pattern: str</span>
<span class="sd">        :param reduction: One of available reductions (&#39;min&#39;, &#39;max&#39;, &#39;sum&#39;, &#39;mean&#39;, &#39;prod&#39;), or callable.</span>
<span class="sd">        :type reduction: str or callable</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :param axes_lengths: Any additional specifications for dimensions.</span>
<span class="sd">        :type axes_lengths: keyword parameter args</span>
<span class="sd">        :return: ivy.Container with each array having einops.reduce applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">ivy</span><span class="o">.</span><span class="n">einops_reduce</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">reduction</span><span class="p">,</span> <span class="o">**</span><span class="n">axes_lengths</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                        <span class="k">else</span> <span class="n">x</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.einops_repeat"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.einops_repeat">[docs]</a>    <span class="k">def</span> <span class="nf">einops_repeat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">axes_lengths</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform einops repeat operation on each sub array in the container.</span>

<span class="sd">        :param pattern: Rearrangement pattern.</span>
<span class="sd">        :type pattern: str</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :param axes_lengths: Any additional specifications for dimensions.</span>
<span class="sd">        :type axes_lengths: keyword parameter args</span>
<span class="sd">        :return: ivy.Container with each array having einops.repeat applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">ivy</span><span class="o">.</span><span class="n">einops_repeat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="o">**</span><span class="n">axes_lengths</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.to_dev"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_dev">[docs]</a>    <span class="k">def</span> <span class="nf">to_dev</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dev</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Move the container arrays to the desired device, specified by device string.</span>

<span class="sd">        :param dev: device to move the array to &#39;cuda:0&#39;, &#39;cuda:1&#39;, &#39;cpu&#39; etc. Keep same device if None.</span>
<span class="sd">        :type dev: ivy.Device, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: The container, but with each sub-array now placed on the target device.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">stop_gradient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">to_dev</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dev</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.stop_gradients"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.stop_gradients">[docs]</a>    <span class="k">def</span> <span class="nf">stop_gradients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">preserve_type</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stop gradients of all array entries in the container.</span>

<span class="sd">        :param preserve_type: Whether to preserve the input type (ivy.Variable or ivy.Array),</span>
<span class="sd">                              otherwise an array is always returned. Default is True.</span>
<span class="sd">        :param preserve_type: bool, optional</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: container with each array having their gradients stopped.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">stop_gradient</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">preserve_type</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_variable</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">x</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.as_variables"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.as_variables">[docs]</a>    <span class="k">def</span> <span class="nf">as_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts all nested arrays to variables, which support gradient computation.</span>

<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: container with each array converted to a variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">variable</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                        <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.as_arrays"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.as_arrays">[docs]</a>    <span class="k">def</span> <span class="nf">as_arrays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts all nested variables to arrays, which do not support gradient computation.</span>

<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: container with each variable converted to an array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">stop_gradient</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_variable</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">(</span><span class="n">x</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span>
            <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.num_arrays"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.num_arrays">[docs]</a>    <span class="k">def</span> <span class="nf">num_arrays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclusive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the number of arrays present at the leaf nodes, including variables by default.</span>

<span class="sd">        :param exclusive: Whether to check if the data type is exclusively an array,</span>
<span class="sd">                          rather than a variable or traced array.</span>
<span class="sd">        :type exclusive: bool, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">exclusive</span><span class="p">))</span><span class="o">.</span><span class="n">to_iterator_values</span><span class="p">())</span></div>

<div class="viewcode-block" id="Container.size_ordered_arrays"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.size_ordered_arrays">[docs]</a>    <span class="k">def</span> <span class="nf">size_ordered_arrays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclusive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a container with keychains mapped to flat keys, and arrays given in order of smallest to largest.</span>

<span class="sd">        :param exclusive: Whether to check if the data type is exclusively an array,</span>
<span class="sd">                          rather than a variable or traced array.</span>
<span class="sd">        :type exclusive: bool, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">array_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">Container</span><span class="o">.</span><span class="n">flatten_key_chain</span><span class="p">(</span><span class="n">kc</span><span class="p">):</span> <span class="n">v</span>
                      <span class="k">for</span> <span class="n">kc</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_iterator</span><span class="p">()</span> <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">exclusive</span><span class="p">)}</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">array_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="n">_reduce</span><span class="p">(</span><span class="n">_mul</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="mi">1</span><span class="p">))),</span>
                             <span class="n">alphabetical_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.to_numpy"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_numpy">[docs]</a>    <span class="k">def</span> <span class="nf">to_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">update_backend</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts all nested ivy arrays to numpy arrays.</span>

<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :param update_backend: Whether to update the ivy backend of the returned container to numpy. Default is True.</span>
<span class="sd">        :type update_backend: bool, optional</span>
<span class="sd">        :return: container with each ivy array converted to a numpy array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">ivy.functional.backends.numpy</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span>
            <span class="n">map_sequences</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">update_backend</span><span class="p">:</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">set_ivy_backend</span><span class="p">(</span><span class="n">ivy</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">numpy</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="Container.from_numpy"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.from_numpy">[docs]</a>    <span class="k">def</span> <span class="nf">from_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts all nested numpy arrays to native backend arrays.</span>

<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: container with each ivy array converted to a numpy array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span>
            <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="Container.arrays_as_lists"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.arrays_as_lists">[docs]</a>    <span class="k">def</span> <span class="nf">arrays_as_lists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts all nested arrays to lists, a useful intermediate step for conversion to other framework array types.</span>

<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :return: container with each array converted to a list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">to_list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span>
            <span class="n">map_sequences</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.to_disk_as_hdf5"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_disk_as_hdf5">[docs]</a>    <span class="k">def</span> <span class="nf">to_disk_as_hdf5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h5_obj_or_filepath</span><span class="p">,</span> <span class="n">starting_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">max_batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save container object to disk, as an h5py file, at the specified filepath.</span>

<span class="sd">        :param h5_obj_or_filepath: Filepath for where to save the container to disk, or h5 object.</span>
<span class="sd">        :type h5_obj_or_filepath: str or h5 object</span>
<span class="sd">        :param starting_index: Batch index for which to start writing to file, if it already exists</span>
<span class="sd">        :type starting_index: int</span>
<span class="sd">        :param mode: H5 read/write mode for writing to disk, [&#39;r&#39;, &#39;r+&#39;, &#39;w&#39;, &#39;w-&#39;, &#39;a&#39;], default is &#39;a&#39;.</span>
<span class="sd">        :type mode: str</span>
<span class="sd">        :param max_batch_size: Maximum batch size for the container on disk, this is useful if later appending to file.</span>
<span class="sd">        :type max_batch_size: int</span>
<span class="sd">        :type h5_obj_or_filepath: str or h5 object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">_h5py</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;You must install python package h5py in order to save containers to disk as hdf5 files.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">_h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_obj_or_filepath</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">h5_obj</span> <span class="o">=</span> <span class="n">h5_obj_or_filepath</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">h5_group</span> <span class="o">=</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">h5_group</span> <span class="o">=</span> <span class="n">h5_obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">value</span><span class="o">.</span><span class="n">to_disk_as_hdf5</span><span class="p">(</span><span class="n">h5_group</span><span class="p">,</span> <span class="n">starting_index</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">max_batch_size</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value_as_np</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="n">value_shape</span> <span class="o">=</span> <span class="n">value_as_np</span><span class="o">.</span><span class="n">shape</span>
                <span class="n">this_batch_size</span> <span class="o">=</span> <span class="n">value_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">max_batch_size</span><span class="p">:</span>
                    <span class="n">max_batch_size</span> <span class="o">=</span> <span class="n">starting_index</span> <span class="o">+</span> <span class="n">this_batch_size</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">dataset_shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">max_batch_size</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">value_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                    <span class="n">maxshape</span> <span class="o">=</span> <span class="p">([</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">dataset_shape</span><span class="p">])</span>
                    <span class="n">h5_obj</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">dataset_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">value_as_np</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">maxshape</span><span class="o">=</span><span class="n">maxshape</span><span class="p">)</span>
                <span class="n">space_left</span> <span class="o">=</span> <span class="n">max_batch_size</span> <span class="o">-</span> <span class="n">starting_index</span>
                <span class="n">amount_to_write</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">this_batch_size</span><span class="p">,</span> <span class="n">space_left</span><span class="p">)</span>
                <span class="n">h5_obj</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">starting_index</span><span class="p">:</span><span class="n">starting_index</span> <span class="o">+</span> <span class="n">amount_to_write</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_as_np</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">amount_to_write</span><span class="p">]</span></div>

<div class="viewcode-block" id="Container.to_disk_as_pickled"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_disk_as_pickled">[docs]</a>    <span class="k">def</span> <span class="nf">to_disk_as_pickled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pickle_filepath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save container object to disk, as an pickled file, at the specified filepath.</span>

<span class="sd">        :param pickle_filepath: Filepath for where to save the container to disk.</span>
<span class="sd">        :type pickle_filepath: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_native</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="nb">open</span><span class="p">(</span><span class="n">pickle_filepath</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">))</span></div>

<div class="viewcode-block" id="Container.to_jsonable"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_jsonable">[docs]</a>    <span class="k">def</span> <span class="nf">to_jsonable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return container with non-jsonable elements converted to string representations, which are jsonable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">return_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">return_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">return_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_jsonable</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_jsonable</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">return_dict</span></div>

<div class="viewcode-block" id="Container.to_disk_as_json"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_disk_as_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_disk_as_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_filepath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save container object to disk, as an json file, at the specified filepath.</span>

<span class="sd">        :param json_filepath: Filepath for where to save the container to disk.</span>
<span class="sd">        :type json_filepath: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_filepath</span><span class="p">,</span> <span class="s1">&#39;w+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_data_file</span><span class="p">:</span>
            <span class="n">_json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_jsonable</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">json_data_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.to_list"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_list">[docs]</a>    <span class="k">def</span> <span class="nf">to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return nested list representation of container object.</span>

<span class="sd">        :return: Container as nested list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">return_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">return_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
            <span class="k">elif</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="s1">&#39;_f&#39;</span><span class="p">:</span>
                <span class="n">return_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">return_list</span></div>

<div class="viewcode-block" id="Container.to_raw"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_raw">[docs]</a>    <span class="k">def</span> <span class="nf">to_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return nested raw representation of container object. This includes restoring lists and tuples passed in the</span>
<span class="sd">        constructor to their original form.</span>

<span class="sd">        :return: Container data in it&#39;s raw form.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">return_item</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">return_item</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">to_raw</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;it_&#39;</span> <span class="ow">and</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_types_to_iteratively_nest</span><span class="p">):</span>
                <span class="n">return_item</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">to_raw</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_item</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">return_item</span></div>

<div class="viewcode-block" id="Container.to_dict"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return nested pure dict representation of container object.</span>

<span class="sd">        :return: Container as nested dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">return_dict</span></div>

<div class="viewcode-block" id="Container.to_iterator"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_iterator">[docs]</a>    <span class="k">def</span> <span class="nf">to_iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chain</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">leaf_keys_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return iterator for traversing through the nested elements of container object.</span>

<span class="sd">        :return: Iterator for the container elements.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">leaf_keys_only</span><span class="p">:</span>
                <span class="n">kc</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kc</span> <span class="o">=</span> <span class="n">key_chain</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="k">if</span> <span class="n">key_chain</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="n">key</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">include_empty</span> <span class="ow">or</span> <span class="n">value</span><span class="p">):</span>
                <span class="k">yield from</span> <span class="n">value</span><span class="o">.</span><span class="n">to_iterator</span><span class="p">(</span><span class="n">kc</span><span class="p">,</span> <span class="n">leaf_keys_only</span><span class="p">,</span> <span class="n">include_empty</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">kc</span><span class="p">,</span> <span class="n">value</span></div>

<div class="viewcode-block" id="Container.to_iterator_values"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_iterator_values">[docs]</a>    <span class="k">def</span> <span class="nf">to_iterator_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return iterator for traversing through the nested values of container object.</span>

<span class="sd">        :return: Iterator for the container values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">include_empty</span> <span class="ow">or</span> <span class="n">value</span><span class="p">):</span>
                <span class="c1"># noinspection PyCompatibility</span>
                <span class="k">yield from</span> <span class="n">value</span><span class="o">.</span><span class="n">to_iterator_values</span><span class="p">(</span><span class="n">include_empty</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">value</span></div>

<div class="viewcode-block" id="Container.to_iterator_keys"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_iterator_keys">[docs]</a>    <span class="k">def</span> <span class="nf">to_iterator_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chain</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">leaf_keys_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return iterator for traversing through the nested keys of container object.</span>

<span class="sd">        :return: Iterator for the container elements.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">leaf_keys_only</span><span class="p">:</span>
                <span class="n">kc</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kc</span> <span class="o">=</span> <span class="n">key_chain</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="k">if</span> <span class="n">key_chain</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="n">key</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">include_empty</span> <span class="ow">or</span> <span class="n">value</span><span class="p">):</span>
                <span class="c1"># noinspection PyCompatibility</span>
                <span class="k">yield from</span> <span class="n">value</span><span class="o">.</span><span class="n">to_iterator_keys</span><span class="p">(</span><span class="n">kc</span><span class="p">,</span> <span class="n">leaf_keys_only</span><span class="p">,</span> <span class="n">include_empty</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">kc</span></div>

<div class="viewcode-block" id="Container.to_flat_list"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.to_flat_list">[docs]</a>    <span class="k">def</span> <span class="nf">to_flat_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return flat list representation of container object.</span>

<span class="sd">        :return: Container as flat list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">([</span><span class="n">item</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_iterator</span><span class="p">()])</span></div>

<div class="viewcode-block" id="Container.from_flat_list"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.from_flat_list">[docs]</a>    <span class="k">def</span> <span class="nf">from_flat_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flat_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return new container object with the same hierarchy, but with values replaced from flat list.</span>

<span class="sd">        :param flat_list: flat list of values to populate container with.</span>
<span class="sd">        :type flat_list: sequence of arrays</span>
<span class="sd">        :return: Container.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">new_value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">from_flat_list</span><span class="p">(</span><span class="n">flat_list</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_value</span> <span class="o">=</span> <span class="n">flat_list</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_value</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">new_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.has_key"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.has_key">[docs]</a>    <span class="k">def</span> <span class="nf">has_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine whether container object has specified key somewhere in the nested structure</span>

<span class="sd">        :return: Boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">has_key</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">def</span> <span class="nf">map_fn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
            <span class="k">nonlocal</span> <span class="n">has_key</span>
            <span class="k">if</span> <span class="n">query_key</span> <span class="ow">in</span> <span class="n">kc</span><span class="p">:</span>
                <span class="n">has_key</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="n">x</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">map_fn</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">has_key</span></div>

<div class="viewcode-block" id="Container.has_key_chain"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.has_key_chain">[docs]</a>    <span class="k">def</span> <span class="nf">has_key_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine whether container object has specified key-chain</span>

<span class="sd">        :return: Boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[/.]&#39;</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Container.find_sub_container"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.find_sub_container">[docs]</a>    <span class="k">def</span> <span class="nf">find_sub_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_cont_to_find</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the sub-container in the current container if it exsits.</span>

<span class="sd">        :param sub_cont_to_find: The sub-container to find.</span>
<span class="sd">        :type sub_cont_to_find: ivy.Container</span>
<span class="sd">        :param partial: Whether to also check for partially complete sub-containers. Default is False.</span>
<span class="sd">        :type partial: bool, optional</span>
<span class="sd">        :return: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">key_chain_found</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">def</span> <span class="nf">_check_sub_cont</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
            <span class="n">sub_cont_key_chains</span> <span class="o">=</span> <span class="n">sub_cont_to_find</span><span class="o">.</span><span class="n">all_key_chains</span><span class="p">()</span>
            <span class="n">kcs_in_sub_cont</span> <span class="o">=</span> <span class="p">[</span><span class="n">kc</span> <span class="ow">in</span> <span class="n">sub_cont</span> <span class="k">for</span> <span class="n">kc</span> <span class="ow">in</span> <span class="n">sub_cont_key_chains</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">kcs_in_sub_cont</span> <span class="ow">and</span> <span class="nb">min</span><span class="p">(</span><span class="n">kcs_in_sub_cont</span><span class="p">)</span> <span class="ow">and</span> \
                    <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">identical</span><span class="p">([</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">sub_cont_to_find</span><span class="p">],</span> <span class="n">partial</span><span class="o">=</span><span class="n">partial</span><span class="p">):</span>
                <span class="k">nonlocal</span> <span class="n">key_chain_found</span>
                <span class="n">key_chain_found</span> <span class="o">=</span> <span class="n">kc</span>
            <span class="k">return</span> <span class="n">sub_cont</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">map_conts</span><span class="p">(</span><span class="n">_check_sub_cont</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">key_chain_found</span></div>

<div class="viewcode-block" id="Container.contains_sub_container"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.contains_sub_container">[docs]</a>    <span class="k">def</span> <span class="nf">contains_sub_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_cont</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine whether the current container contains the sub-container, with matching structure and array values.</span>

<span class="sd">        :param sub_cont: The sub-container to check.</span>
<span class="sd">        :type sub_cont: ivy.Container</span>
<span class="sd">        :param partial: Whether to also check for partially complete sub-containers. Default is False.</span>
<span class="sd">        :type partial: bool, optional</span>
<span class="sd">        :return: Bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_sub_container</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">partial</span><span class="p">),</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Container.assert_contains_sub_container"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.assert_contains_sub_container">[docs]</a>    <span class="k">def</span> <span class="nf">assert_contains_sub_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_cont</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Asserts that the current container contains the sub-container, otherwise exception raised with the</span>
<span class="sd">        diff printed to screen.</span>

<span class="sd">        :param sub_cont: The sub-container to check.</span>
<span class="sd">        :type sub_cont: ivy.Container</span>
<span class="sd">        :param partial: Whether to also check for partially complete sub-containers. Default is False.</span>
<span class="sd">        :type partial: bool, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains_sub_container</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">partial</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
            <span class="n">key_chain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_sub_structure</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">check_shapes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">key_chain</span><span class="p">:</span>
                <span class="n">key_chain</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="c1"># noinspection PyTypeChecker</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;Containers did not have identical structure and values:</span><span class="se">\n\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">Container</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">key_chain</span><span class="p">],</span> <span class="n">sub_cont</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Container.find_sub_structure"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.find_sub_structure">[docs]</a>    <span class="k">def</span> <span class="nf">find_sub_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_struc_to_find</span><span class="p">,</span> <span class="n">check_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the sub-container structure in the current container if it exsits.</span>

<span class="sd">        :param sub_struc_to_find: The sub-container to find.</span>
<span class="sd">        :type sub_struc_to_find: ivy.Container</span>
<span class="sd">        :param check_shapes: Whether to check array shapes in the sub-structure. Default is True.</span>
<span class="sd">        :type check_shapes: bool, optional</span>
<span class="sd">        :param partial: Whether to also check for partially complete sub-containers. Default is False.</span>
<span class="sd">        :type partial: bool, optional</span>
<span class="sd">        :return: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">key_chain_found</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">def</span> <span class="nf">_check_sub_cont</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
            <span class="n">sub_struc_key_chains</span> <span class="o">=</span> <span class="n">sub_struc_to_find</span><span class="o">.</span><span class="n">all_key_chains</span><span class="p">()</span>
            <span class="n">kcs_in_sub_cont</span> <span class="o">=</span> <span class="p">[</span><span class="n">kc</span> <span class="ow">in</span> <span class="n">sub_cont</span> <span class="k">for</span> <span class="n">kc</span> <span class="ow">in</span> <span class="n">sub_struc_key_chains</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">kcs_in_sub_cont</span> <span class="ow">and</span> <span class="nb">min</span><span class="p">(</span><span class="n">kcs_in_sub_cont</span><span class="p">)</span> <span class="ow">and</span> \
                    <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">identical_structure</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">sub_struc_to_find</span><span class="p">],</span> <span class="n">check_shapes</span><span class="o">=</span><span class="n">check_shapes</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="n">partial</span><span class="p">):</span>
                <span class="k">nonlocal</span> <span class="n">key_chain_found</span>
                <span class="n">key_chain_found</span> <span class="o">=</span> <span class="n">kc</span>
            <span class="k">return</span> <span class="n">sub_cont</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">map_conts</span><span class="p">(</span><span class="n">_check_sub_cont</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">key_chain_found</span></div>

<div class="viewcode-block" id="Container.contains_sub_structure"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.contains_sub_structure">[docs]</a>    <span class="k">def</span> <span class="nf">contains_sub_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_cont</span><span class="p">,</span> <span class="n">check_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine whether the current container contains the sub-container structure.</span>

<span class="sd">        :param sub_cont: The sub-container to check.</span>
<span class="sd">        :type sub_cont: ivy.Container</span>
<span class="sd">        :param check_shapes: Whether to check array shapes in the sub-structure. Default is True.</span>
<span class="sd">        :type check_shapes: bool, optional</span>
<span class="sd">        :param partial: Whether to also check for partially complete sub-containers. Default is False.</span>
<span class="sd">        :type partial: bool, optional</span>
<span class="sd">        :return: Bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_sub_structure</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">check_shapes</span><span class="p">,</span> <span class="n">partial</span><span class="p">),</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Container.assert_contains_sub_structure"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.assert_contains_sub_structure">[docs]</a>    <span class="k">def</span> <span class="nf">assert_contains_sub_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_cont</span><span class="p">,</span> <span class="n">check_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Asserts that the current container contains the sub-container structure, otherwise exception raised with the</span>
<span class="sd">        diff printed to screen.</span>

<span class="sd">        :param sub_cont: The sub-container to check.</span>
<span class="sd">        :type sub_cont: ivy.Container</span>
<span class="sd">        :param check_shapes: Whether to check array shapes in the sub-structure. Default is True.</span>
<span class="sd">        :type check_shapes: bool, optional</span>
<span class="sd">        :param partial: Whether to also check for partially complete sub-containers. Default is False.</span>
<span class="sd">        :type partial: bool, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains_sub_structure</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">check_shapes</span><span class="p">,</span> <span class="n">partial</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
            <span class="n">key_chain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_sub_structure</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">,</span> <span class="n">check_shapes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">key_chain</span><span class="p">:</span>
                <span class="n">key_chain</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="c1"># noinspection PyTypeChecker</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;Containers did not have identical structure:</span><span class="se">\n\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">Container</span><span class="o">.</span><span class="n">structural_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">key_chain</span><span class="p">],</span> <span class="n">sub_cont</span><span class="p">,</span> <span class="n">detect_key_diffs</span><span class="o">=</span><span class="ow">not</span> <span class="n">partial</span><span class="p">,</span>
                                          <span class="n">detect_shape_diffs</span><span class="o">=</span><span class="n">check_shapes</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;diff_only&#39;</span> <span class="k">if</span> <span class="n">partial</span> <span class="k">else</span> <span class="s1">&#39;all&#39;</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Container.has_nans"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.has_nans">[docs]</a>    <span class="k">def</span> <span class="nf">has_nans</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_infs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">leafwise</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine whether arrays in the container contain any nans, as well as infs or -infs if specified.</span>

<span class="sd">        :param include_infs: Whether to include infs and -infs in the check. Default is True.</span>
<span class="sd">        :type include_infs: bool, optional</span>
<span class="sd">        :param leafwise: Whether to apply the check leaf-wise, and return a container of booleans. Default is False,</span>
<span class="sd">                         in which case the check is applied across the entire container, returning a single boolean.</span>
<span class="sd">        :type leafwise: bool, optional</span>
<span class="sd">        :return: Whether the container has any nans, applied either leafwise or across the entire container.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">leafwise_res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">ivy</span><span class="o">.</span><span class="n">has_nans</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">include_infs</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">leafwise</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">leafwise_res</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">leafwise_res</span><span class="o">.</span><span class="n">to_iterator</span><span class="p">()])</span></div>

<div class="viewcode-block" id="Container.at_keys"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.at_keys">[docs]</a>    <span class="k">def</span> <span class="nf">at_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queries</span><span class="p">,</span> <span class="n">ignore_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">containing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query container object at specified keys, either as list or nested dict.</span>

<span class="sd">        :param queries: The keys to query.</span>
<span class="sd">        :type queries: sequence of strs or single str</span>
<span class="sd">        :param ignore_none: Whether to ignore None input. Default is True.</span>
<span class="sd">        :type ignore_none: bool, optional</span>
<span class="sd">        :param containing: Whether to include keys which only contain the query substrings. Default is False.</span>
<span class="sd">        :type containing: bool, optional</span>
<span class="sd">        :param ignore_key_errors: Whether to ignore Key-errors when trying to access the dict. Default is False.</span>
<span class="sd">        :type ignore_key_errors: bool, optional</span>
<span class="sd">        :return: sub-container containing only key-chains containing the specified keys.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">queries</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ignore_none</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="n">key_chains_to_keep</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">queries</span> <span class="o">=</span> <span class="p">[</span><span class="n">queries</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">map_fn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
            <span class="k">nonlocal</span> <span class="n">key_chains_to_keep</span>
            <span class="n">kc_split</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[/.]&#39;</span><span class="p">,</span> <span class="n">kc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">query_key</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">query_key</span> <span class="ow">in</span> <span class="n">kc_split</span> <span class="ow">or</span> <span class="p">(</span><span class="n">containing</span> <span class="ow">and</span> <span class="nb">min</span><span class="p">([</span><span class="n">query_key</span> <span class="ow">in</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kc_split</span><span class="p">])):</span>
                    <span class="n">key_chains_to_keep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kc</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">x</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">map_fn</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">at_key_chains</span><span class="p">(</span><span class="n">key_chains_to_keep</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="n">ignore_key_errors</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.at_key_chain"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.at_key_chain">[docs]</a>    <span class="k">def</span> <span class="nf">at_key_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query container object at a specified key-chain</span>

<span class="sd">        :return: sub-container or value at specified key chain</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[/.]&#39;</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ignore_key_errors</span><span class="p">:</span>
                    <span class="k">return</span>
                <span class="k">raise</span> <span class="n">e</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="Container.at_key_chains"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.at_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">at_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">ignore_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query container object at specified key-chains, either as list or nested dict.</span>

<span class="sd">        :return: sub-container containing only the specified key chains</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key_chains</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ignore_none</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_chains</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_at_key_chains_input_as_seq</span><span class="p">(</span><span class="n">key_chains</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="n">ignore_key_errors</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_chains</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_at_key_chains_input_as_dict</span><span class="p">(</span><span class="n">key_chains</span><span class="p">,</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="n">ignore_key_errors</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_chains</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_at_key_chains_input_as_seq</span><span class="p">([</span><span class="n">key_chains</span><span class="p">],</span> <span class="n">ignore_key_errors</span><span class="o">=</span><span class="n">ignore_key_errors</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Invalid type for input key_chains, must either be a list, tuple, dict, or ivy.Container,&#39;</span>
                            <span class="s1">&#39;but found type </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">key_chains</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Container.all_key_chains"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.all_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">all_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return all key-chains for the current container.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">kc</span> <span class="k">for</span> <span class="n">kc</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_iterator</span><span class="p">(</span><span class="n">include_empty</span><span class="o">=</span><span class="n">include_empty</span><span class="p">)]</span></div>

<div class="viewcode-block" id="Container.key_chains_containing"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.key_chains_containing">[docs]</a>    <span class="k">def</span> <span class="nf">key_chains_containing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_str</span><span class="p">,</span> <span class="n">include_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of all key-chains containing a given sub-string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">kc</span> <span class="k">for</span> <span class="n">kc</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_iterator</span><span class="p">(</span><span class="n">include_empty</span><span class="o">=</span><span class="n">include_empty</span><span class="p">)</span> <span class="k">if</span> <span class="n">sub_str</span> <span class="ow">in</span> <span class="n">kc</span><span class="p">]</span></div>

<div class="viewcode-block" id="Container.set_at_keys"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.set_at_keys">[docs]</a>    <span class="k">def</span> <span class="nf">set_at_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set values of container object at specified keys</span>

<span class="sd">        :return: new container with updated value at each key</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">target_dict</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">target_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">set_at_keys</span><span class="p">(</span><span class="n">target_dict</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.set_at_key_chain"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.set_at_key_chain">[docs]</a>    <span class="k">def</span> <span class="nf">set_at_key_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set value of container object at a specified key-chain</span>

<span class="sd">        :return: new container with updated value at key chain</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[/.]&#39;</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">cont</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">sub_cont</span> <span class="o">=</span> <span class="n">cont</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sub_cont</span><span class="p">:</span>
                <span class="n">sub_cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
            <span class="n">sub_cont</span> <span class="o">=</span> <span class="n">sub_cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">sub_cont</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">cont</span></div>

<div class="viewcode-block" id="Container.overwrite_at_key_chain"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.overwrite_at_key_chain">[docs]</a>    <span class="k">def</span> <span class="nf">overwrite_at_key_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overwrite value of container object at a specified key-chain</span>

<span class="sd">        :return: new container with updated value at key chain, provided it existed before.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[/.]&#39;</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">cont</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">sub_cont</span> <span class="o">=</span> <span class="n">cont</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sub_cont</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;key chain must already exist in container in order to call overwrite_at_key_chain&#39;</span><span class="p">)</span>
            <span class="n">sub_cont</span> <span class="o">=</span> <span class="n">sub_cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sub_cont</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;key chain must already exist in container in order to call overwrite_at_key_chain&#39;</span><span class="p">)</span>
        <span class="n">sub_cont</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">cont</span></div>

<div class="viewcode-block" id="Container.set_at_key_chains"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.set_at_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">set_at_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_dict</span><span class="p">,</span> <span class="n">return_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set values of container object at specified key-chains</span>

<span class="sd">        :return: new container with updated values at the key chains</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">return_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
                <span class="n">return_dict</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">target_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_at_key_chains</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">inplace</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.overwrite_at_key_chains"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.overwrite_at_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">overwrite_at_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_dict</span><span class="p">,</span> <span class="n">return_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overwrite values of container object at specified key-chains</span>

<span class="sd">        :return: new container with updated values at the key chains, provided they existed before.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">return_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
                <span class="n">return_dict</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">target_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">return_dict</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;key chain must already exist in container in order to call overwrite_at_key_chains&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overwrite_at_key_chains</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">inplace</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.prune_keys"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.prune_keys">[docs]</a>    <span class="k">def</span> <span class="nf">prune_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_keys</span><span class="p">,</span> <span class="n">ignore_none</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursively prune set of keys</span>

<span class="sd">        :return: Container with key-chains containing the specified keys pruned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">query_keys</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ignore_none</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="n">key_chains_to_prune</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query_keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">query_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">query_keys</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">map_fn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
            <span class="k">nonlocal</span> <span class="n">key_chains_to_prune</span>
            <span class="k">for</span> <span class="n">query_key</span> <span class="ow">in</span> <span class="n">query_keys</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">query_key</span> <span class="ow">in</span> <span class="n">kc</span><span class="p">:</span>
                    <span class="n">key_chains_to_prune</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kc</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">x</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">map_fn</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prune_key_chains</span><span class="p">(</span><span class="n">key_chains_to_prune</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.prune_key_chain"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.prune_key_chain">[docs]</a>    <span class="k">def</span> <span class="nf">prune_key_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursively prune chain of keys, specified as &#39;key1/key2/key3/...&#39;</span>

<span class="sd">        :return: Container with keys in key chain pruned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keys_in_chain</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[/.]&#39;</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">)</span>
        <span class="n">out_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">keys_in_chain</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys_in_chain</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">new_val</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">new_val</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">prune_key_chain</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">keys_in_chain</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_val</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">out_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_val</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_val</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_val</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">out_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys_in_chain</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">!=</span> <span class="n">keys_in_chain</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">out_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">out_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.prune_key_chains"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.prune_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">prune_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">ignore_none</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursively prune set of key chains</span>

<span class="sd">        :return: Container with keys in the set of key chains pruned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key_chains</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ignore_none</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_chains</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prune_key_chains_input_as_seq</span><span class="p">(</span><span class="n">key_chains</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_chains</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prune_key_chains_input_as_dict</span><span class="p">(</span><span class="n">key_chains</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_chains</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prune_key_chains_input_as_seq</span><span class="p">([</span><span class="n">key_chains</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Invalid type for input key_chains, must either be a list, tuple, dict, or ivy.Container,&#39;</span>
                            <span class="s1">&#39;but found type </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">key_chains</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Container.format_key_chains"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.format_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">format_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">format_fn</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format all key-chains, using the formatting function</span>

<span class="sd">        :return: Container with the same key-chain structure, but the key strings formatted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">({</span><span class="n">format_fn</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_iterator</span><span class="p">()})</span></div>

<div class="viewcode-block" id="Container.sort_by_key"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.sort_by_key">[docs]</a>    <span class="k">def</span> <span class="nf">sort_by_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">v_back</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">sort_by_key</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v_back</span> <span class="o">=</span> <span class="n">v</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_back</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">new_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.prune_empty"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.prune_empty">[docs]</a>    <span class="k">def</span> <span class="nf">prune_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep_nones</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursively prunes empty keys from the container dict structure.</span>
<span class="sd">        Returns None if the entire container is empty.</span>

<span class="sd">        :return: Container with empty keys pruned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">new_value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">prune_empty</span><span class="p">(</span><span class="n">keep_nones</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">new_value</span><span class="p">:</span>
                    <span class="n">out_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_value</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">or</span> <span class="n">keep_nones</span><span class="p">:</span>
                <span class="n">out_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">out_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">base</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="Container.prune_key_from_key_chains"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.prune_key_from_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">prune_key_from_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">absolute</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">containing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursively prune absolute key or key containing a certain substring from all key chains.</span>

<span class="sd">        :param absolute: The absolute key to detect in the key chains.</span>
<span class="sd">        :type absolute: str, optional</span>
<span class="sd">        :param containing: A substring to check each key for, when deciding which keys to prune.</span>
<span class="sd">        :type containing: str, optional</span>
<span class="sd">        :return: Container with specified key or substring-containing-key from all key chains removed from the chain.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">absolute</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">containing</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;At least one of absolute or containing arguments must be specified.&#39;</span><span class="p">)</span>
        <span class="n">out_cont</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">absolute</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">==</span> <span class="n">absolute</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">containing</span> <span class="ow">and</span> <span class="n">containing</span> <span class="ow">in</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                    <span class="n">out_cont</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">out_cont</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">out_cont</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">out_cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">prune_key_from_key_chains</span><span class="p">(</span><span class="n">absolute</span><span class="p">,</span> <span class="n">containing</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out_cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">out_cont</span></div>

<div class="viewcode-block" id="Container.prune_keys_from_key_chains"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.prune_keys_from_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">prune_keys_from_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">absolute</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">containing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursively prune absolute keys or keys containing certain substrings from all key chains.</span>

<span class="sd">        :param absolute: The absolute key to detect in the key chains.</span>
<span class="sd">        :type absolute: sequence of strs, optional</span>
<span class="sd">        :param containing: A substring to check each key for, when deciding which keys to prune.</span>
<span class="sd">        :type containing: sequence of strs, optional</span>
<span class="sd">        :return: Container with specified keys or substring-containing-keys from all key chains removed from the chain.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">absolute</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">containing</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;At least one of absolute or containing arguments must be specified.&#39;</span><span class="p">)</span>
        <span class="n">out_cont</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">absolute</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">absolute</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">containing</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">([</span><span class="n">con</span> <span class="ow">in</span> <span class="n">key</span> <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="n">containing</span><span class="p">])):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                    <span class="n">out_cont</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">out_cont</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">out_cont</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">out_cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">prune_key_from_key_chains</span><span class="p">(</span><span class="n">absolute</span><span class="p">,</span> <span class="n">containing</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out_cont</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">out_cont</span></div>

<div class="viewcode-block" id="Container.restructure_key_chains"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.restructure_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">restructure_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keychain_mapping</span><span class="p">,</span> <span class="n">keep_orig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new container with the same contents, but a new key-chain structure. Given by the mapping with keys as</span>
<span class="sd">        old key-chains and values as new key-chains.</span>

<span class="sd">        :param keychain_mapping: A dict with keys as old key-chains and values as new key-chains.</span>
<span class="sd">        :type keychain_mapping: dict</span>
<span class="sd">        :param keep_orig: Whether to keep the original keys, or start from a new empty container. Default is True.</span>
<span class="sd">        :type keep_orig: bool, optional</span>
<span class="sd">        :param replace: Whether to replace the old key-chains by the new ones. Default is True.</span>
<span class="sd">        :type replace: bool, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="n">keep_orig</span> <span class="k">else</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">old_kc</span><span class="p">,</span> <span class="n">new_kc</span> <span class="ow">in</span> <span class="n">keychain_mapping</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">replace</span> <span class="ow">and</span> <span class="n">old_kc</span> <span class="ow">in</span> <span class="n">new_cont</span><span class="p">:</span>
                <span class="n">new_cont</span> <span class="o">=</span> <span class="n">new_cont</span><span class="o">.</span><span class="n">prune_key_chain</span><span class="p">(</span><span class="n">old_kc</span><span class="p">)</span>
            <span class="n">new_cont</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">new_cont</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">({</span><span class="n">new_kc</span><span class="p">:</span> <span class="bp">self</span><span class="p">[</span><span class="n">old_kc</span><span class="p">]}))</span>
        <span class="k">return</span> <span class="n">new_cont</span></div>

<div class="viewcode-block" id="Container.restructure"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.restructure">[docs]</a>    <span class="k">def</span> <span class="nf">restructure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">keep_orig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new container with the same contents, but a new key-chain structure, and transposes and/or reshaped</span>
<span class="sd">        arrays. Given by the mapping with keys as old key-chains and values as new key-chains.</span>

<span class="sd">        :param mapping: A dict with keys as old key-chains and values as new key-chains.</span>
<span class="sd">        :type mapping: dict</span>
<span class="sd">        :param keep_orig: Whether to keep the original keys, are start from a new container. Default is True.</span>
<span class="sd">        :type keep_orig: bool, optional</span>
<span class="sd">        :param replace: Whether to replace the old key-chains by the new ones. Default is True.</span>
<span class="sd">        :type replace: bool, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="n">keep_orig</span> <span class="k">else</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">old_kc</span><span class="p">,</span> <span class="n">new</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">replace</span> <span class="ow">and</span> <span class="n">old_kc</span> <span class="ow">in</span> <span class="n">new_cont</span><span class="p">:</span>
                <span class="n">new_cont</span> <span class="o">=</span> <span class="n">new_cont</span><span class="o">.</span><span class="n">prune_key_chain</span><span class="p">(</span><span class="n">old_kc</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">old_kc</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">new_kc</span> <span class="o">=</span> <span class="n">new</span><span class="p">[</span><span class="s1">&#39;key_chain&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s1">&#39;pattern&#39;</span> <span class="ow">in</span> <span class="n">new</span><span class="p">:</span>
                    <span class="n">pattern</span> <span class="o">=</span> <span class="n">new</span><span class="p">[</span><span class="s1">&#39;pattern&#39;</span><span class="p">]</span>
                    <span class="n">axes_lengths</span> <span class="o">=</span> <span class="n">new</span><span class="p">[</span><span class="s1">&#39;axes_lengths&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;axes_lengths&#39;</span> <span class="ow">in</span> <span class="n">new</span> <span class="k">else</span> <span class="p">{}</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">einops_rearrange</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="o">**</span><span class="n">axes_lengths</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">einops_rearrange</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="o">**</span><span class="n">axes_lengths</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_kc</span> <span class="o">=</span> <span class="n">new</span>
            <span class="n">new_cont</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">new_cont</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">({</span><span class="n">new_kc</span><span class="p">:</span> <span class="n">val</span><span class="p">}))</span>
        <span class="k">return</span> <span class="n">new_cont</span></div>

<div class="viewcode-block" id="Container.flatten_key_chains"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.flatten_key_chains">[docs]</a>    <span class="k">def</span> <span class="nf">flatten_key_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">above_height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">below_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a flat (depth-1) container, which all nested key-chains flattened.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">({</span><span class="n">Container</span><span class="o">.</span><span class="n">flatten_key_chain</span><span class="p">(</span><span class="n">kc</span><span class="p">,</span> <span class="n">above_height</span><span class="o">=</span><span class="n">above_height</span><span class="p">,</span> <span class="n">below_depth</span><span class="o">=</span><span class="n">below_depth</span><span class="p">):</span> <span class="n">v</span>
                          <span class="k">for</span> <span class="n">kc</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_iterator</span><span class="p">(</span><span class="n">include_empty</span><span class="o">=</span><span class="n">include_empty</span><span class="p">)},</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.copy"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a copy of this container.</span>

<span class="sd">        :return: A copy of the container</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.deep_copy"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.deep_copy">[docs]</a>    <span class="k">def</span> <span class="nf">deep_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a deep copy (copying all internal tensors) of this container.</span>

<span class="sd">        :return: A deep copy of the container</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">ivy</span><span class="o">.</span><span class="n">copy_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.map"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.map">[docs]</a>    <span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">map_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">key_chain</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply function to all array values of container</span>

<span class="sd">        :param func: Function to apply to each container entry</span>
<span class="sd">        :type func: python function</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map method to sequences (lists, tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :param inplace: Whether to apply the mapping inplace, or return a new container. Default is False.</span>
<span class="sd">        :type inplace: bool, optional</span>
<span class="sd">        :param map_sequences: Whether to also map to sequences (lists and tuples). Default is False.</span>
<span class="sd">        :type map_sequences: bool, optional</span>
<span class="sd">        :param key_chain: Chain of keys for this dict entry</span>
<span class="sd">        :type key_chain: str</span>
<span class="sd">        :return: New container following the function mapped to each sub-array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">inplace</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">this_key_chain</span> <span class="o">=</span> <span class="n">key</span> <span class="k">if</span> <span class="n">key_chain</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="p">(</span><span class="n">key_chain</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">map_sequences</span><span class="p">,</span> <span class="n">inplace</span><span class="p">,</span> <span class="n">this_key_chain</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">prune_unapplied</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="n">map_sequences</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">nested_map</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">prune_unapplied</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key_chains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">this_key_chain</span> <span class="ow">in</span> <span class="n">key_chains</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">to_apply</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                            <span class="n">this_key_chain</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key_chains</span> <span class="ow">and</span> <span class="n">to_apply</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">prune_unapplied</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                        <span class="k">continue</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">this_key_chain</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.map_conts"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.map_conts">[docs]</a>    <span class="k">def</span> <span class="nf">map_conts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">key_chains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_apply</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">key_chain</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                  <span class="n">include_self</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply function to all sub-contains in the container.</span>

<span class="sd">        :param func: Function to apply to each sub-container</span>
<span class="sd">        :type func: python function</span>
<span class="sd">        :param key_chains: The key-chains to apply or not apply the method to. Default is None.</span>
<span class="sd">        :type key_chains: list or dict of strs, optional</span>
<span class="sd">        :param to_apply: If True, the method will be applied to key_chains, otherwise key_chains will be skipped.</span>
<span class="sd">                         Default is True.</span>
<span class="sd">        :type to_apply: bool, optional</span>
<span class="sd">        :param prune_unapplied: Whether to prune key_chains for which the function was not applied. Default is False.</span>
<span class="sd">        :type prune_unapplied: bool, optional</span>
<span class="sd">        :param inplace: Whether to apply the mapping inplace, or return a new container. Default is False.</span>
<span class="sd">        :type inplace: bool, optional</span>
<span class="sd">        :param key_chain: Chain of keys for this dict entry</span>
<span class="sd">        :type key_chain: str</span>
<span class="sd">        :param include_self: Whether to also apply the (possiby in-place) function to this container. Default is True.</span>
<span class="sd">        :type include_self: bool, optional</span>
<span class="sd">        :return: New container following the function mapped to each sub-container.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">inplace</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">this_key_chain</span> <span class="o">=</span> <span class="n">key</span> <span class="k">if</span> <span class="n">key_chain</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="p">(</span><span class="n">key_chain</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">map_conts</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">key_chains</span><span class="p">,</span> <span class="n">to_apply</span><span class="p">,</span> <span class="n">prune_unapplied</span><span class="p">,</span> <span class="n">inplace</span><span class="p">,</span> <span class="n">this_key_chain</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">prune_unapplied</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key_chains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">((</span><span class="n">this_key_chain</span> <span class="ow">in</span> <span class="n">key_chains</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">to_apply</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                        <span class="n">this_key_chain</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key_chains</span> <span class="ow">and</span> <span class="n">to_apply</span><span class="p">))</span> <span class="ow">and</span> <span class="n">prune_unapplied</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">return_dict</span> <span class="k">if</span> <span class="n">inplace</span> <span class="k">else</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key_chain</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="n">include_self</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">key_chain</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="Container.dtype"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.dtype">[docs]</a>    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return container, with all entries replaced with their data types.</span>

<span class="sd">        :return: New datatype container</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">x</span><span class="p">))</span></div>

<div class="viewcode-block" id="Container.with_entries_as_lists"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.with_entries_as_lists">[docs]</a>    <span class="k">def</span> <span class="nf">with_entries_as_lists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return container object, with each array entry in the container cast to a list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">to_list</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">to_list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">x</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">to_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.reshape_like"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.reshape_like">[docs]</a>    <span class="k">def</span> <span class="nf">reshape_like</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_dict</span><span class="p">,</span> <span class="n">leading_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_cont</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set shapes of container entries to shapes specified by new container with the same key structure</span>

<span class="sd">        :return: new container with values of updated shapes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">leading_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">leading_shape</span><span class="p">,</span> <span class="nb">list</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">return_cont</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">return_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">v_shape</span><span class="p">),</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">target_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">return_cont</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v_shape</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">return_cont</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reshape_like</span><span class="p">(</span><span class="n">v_shape</span><span class="p">,</span> <span class="n">leading_shape</span><span class="p">,</span> <span class="n">return_cont</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_cont</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">leading_shape</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">v_shape</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_cont</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.create_if_absent"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.create_if_absent">[docs]</a>    <span class="k">def</span> <span class="nf">create_if_absent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a key to the container with corresponding value, if it is not already present. otherwise, do nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_at_key_chain</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.if_exists"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.if_exists">[docs]</a>    <span class="k">def</span> <span class="nf">if_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the sub-container at the following key if it exists, otherwise None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span></div>

<div class="viewcode-block" id="Container.try_kc"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.try_kc">[docs]</a>    <span class="k">def</span> <span class="nf">try_kc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tries the following key or key chain, returning self if not present.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Container.cutoff_at_depth"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.cutoff_at_depth">[docs]</a>    <span class="k">def</span> <span class="nf">cutoff_at_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth_cutoff</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">total_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span>
        <span class="n">copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">def</span> <span class="nf">_maybe_cutoff</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">total_depth</span> <span class="o">-</span> <span class="n">copy</span><span class="p">[</span><span class="n">kc</span><span class="p">]</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">&lt;</span> <span class="n">depth_cutoff</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cont</span>
            <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
                <span class="n">cont</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">Container</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_conts</span><span class="p">(</span><span class="n">_maybe_cutoff</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="Container.cutoff_at_height"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.cutoff_at_height">[docs]</a>    <span class="k">def</span> <span class="nf">cutoff_at_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height_cutoff</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">def</span> <span class="nf">_maybe_cutoff</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">copy</span><span class="p">[</span><span class="n">kc</span><span class="p">]</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">&gt;</span> <span class="n">height_cutoff</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cont</span>
            <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
                <span class="n">cont</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">Container</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_conts</span><span class="p">(</span><span class="n">_maybe_cutoff</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="k">def</span> <span class="nf">_slice_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_slice</span><span class="p">):</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_slice</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">key_slice</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">key_slice</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alphabetical_keys</span>
            <span class="n">start_char</span> <span class="o">=</span> <span class="n">key_slice</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">end_char</span> <span class="o">=</span> <span class="n">key_slice</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">start_idx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">start_char</span><span class="p">])</span>
            <span class="n">end_idx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_char</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">key_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">desired_keys</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="n">key_slice</span><span class="p">]</span>
        <span class="c1"># noinspection PyUnresolvedReferences</span>
        <span class="k">return</span> <span class="n">ret</span><span class="o">.</span><span class="n">at_key_chains</span><span class="p">(</span><span class="n">desired_keys</span><span class="p">)</span>

<div class="viewcode-block" id="Container.slice_keys"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.slice_keys">[docs]</a>    <span class="k">def</span> <span class="nf">slice_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_slice</span><span class="p">,</span> <span class="n">all_depths</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">top_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span>
        <span class="k">if</span> <span class="n">all_depths</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_slice</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">first_slice</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">key_slice</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">top_depth</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">d</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key_slice</span><span class="p">:</span>
                        <span class="n">key_slice</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_slice</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">key_slice</span> <span class="o">=</span> <span class="p">{</span><span class="n">d</span><span class="p">:</span> <span class="n">key_slice</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">top_depth</span><span class="o">+</span><span class="mi">1</span><span class="p">)}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_slice</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">_fn</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
                <span class="n">depth</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">kc</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">kc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">depth</span> <span class="ow">in</span> <span class="n">key_slice</span><span class="p">:</span>
                    <span class="c1"># noinspection PyProtectedMember</span>
                    <span class="k">return</span> <span class="n">cont</span><span class="o">.</span><span class="n">_slice_keys</span><span class="p">(</span><span class="n">key_slice</span><span class="p">[</span><span class="n">depth</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">cont</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_conts</span><span class="p">(</span><span class="n">_fn</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slice_keys</span><span class="p">(</span><span class="n">key_slice</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.with_print_limit"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.with_print_limit">[docs]</a>    <span class="k">def</span> <span class="nf">with_print_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_limit</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">_update_print_limit</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
            <span class="n">cont</span><span class="o">.</span><span class="n">_print_limit</span> <span class="o">=</span> <span class="n">print_limit</span>
            <span class="k">return</span> <span class="n">cont</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_conts</span><span class="p">(</span><span class="n">_update_print_limit</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="c1"># noinspection PyTypeChecker</span>
<div class="viewcode-block" id="Container.remove_print_limit"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.remove_print_limit">[docs]</a>    <span class="k">def</span> <span class="nf">remove_print_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_print_limit</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.with_key_length_limit"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.with_key_length_limit">[docs]</a>    <span class="k">def</span> <span class="nf">with_key_length_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_length_limit</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">_update_key_length_limit</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
            <span class="n">cont</span><span class="o">.</span><span class="n">_key_length_limit</span> <span class="o">=</span> <span class="n">key_length_limit</span>
            <span class="k">return</span> <span class="n">cont</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_conts</span><span class="p">(</span><span class="n">_update_key_length_limit</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="Container.remove_key_length_limit"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.remove_key_length_limit">[docs]</a>    <span class="k">def</span> <span class="nf">remove_key_length_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_key_length_limit</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.with_print_indent"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.with_print_indent">[docs]</a>    <span class="k">def</span> <span class="nf">with_print_indent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_indent</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">_update_print_indent</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
            <span class="n">cont</span><span class="o">.</span><span class="n">_print_indent</span> <span class="o">=</span> <span class="n">print_indent</span>
            <span class="k">return</span> <span class="n">cont</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_conts</span><span class="p">(</span><span class="n">_update_print_indent</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="Container.with_print_line_spacing"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.with_print_line_spacing">[docs]</a>    <span class="k">def</span> <span class="nf">with_print_line_spacing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_line_spacing</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">_update_print_line_spacing</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
            <span class="n">cont</span><span class="o">.</span><span class="n">_print_line_spacing</span> <span class="o">=</span> <span class="n">print_line_spacing</span>
            <span class="k">return</span> <span class="n">cont</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_conts</span><span class="p">(</span><span class="n">_update_print_line_spacing</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="Container.with_default_key_color"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.with_default_key_color">[docs]</a>    <span class="k">def</span> <span class="nf">with_default_key_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default_key_color</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">_update_default_key_color</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
            <span class="n">cont</span><span class="o">.</span><span class="n">_default_key_color</span> <span class="o">=</span> <span class="n">default_key_color</span>
            <span class="k">return</span> <span class="n">cont</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_conts</span><span class="p">(</span><span class="n">_update_default_key_color</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="Container.with_ivy_backend"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.with_ivy_backend">[docs]</a>    <span class="k">def</span> <span class="nf">with_ivy_backend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ivy_backend</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ivyh</span><span class="o">=</span><span class="n">ivy_backend</span><span class="p">)</span></div>

<div class="viewcode-block" id="Container.set_ivy_backend"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.set_ivy_backend">[docs]</a>    <span class="k">def</span> <span class="nf">set_ivy_backend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ivy_backend</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_local_ivy</span> <span class="o">=</span> <span class="n">ivy_backend</span></div>

<div class="viewcode-block" id="Container.show"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="c1"># noinspection PyUnresolvedReferences</span>
<div class="viewcode-block" id="Container.show_sub_container"><a class="viewcode-back" href="../../container/Container.html#ivy.container.Container.show_sub_container">[docs]</a>    <span class="k">def</span> <span class="nf">show_sub_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_cont_or_keychain</span><span class="p">):</span>

        <span class="c1"># copy this container</span>
        <span class="n">this_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># get the sub-container</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sub_cont_or_keychain</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">sub_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">at_key_chain</span><span class="p">(</span><span class="n">sub_cont_or_keychain</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sub_cont</span> <span class="o">=</span> <span class="n">sub_cont_or_keychain</span>

        <span class="c1"># find the key chain of the sub-container</span>
        <span class="n">sub_cont_kc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_sub_container</span><span class="p">(</span><span class="n">sub_cont</span><span class="p">)</span>

        <span class="c1"># show this container if key-chain not found, and return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_cont_kc</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># otherwise, replace sub-container in this container with known key</span>
        <span class="n">this_cont</span><span class="p">[</span><span class="n">sub_cont_kc</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="p">({</span><span class="s1">&#39;SUB_CONT&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span>

        <span class="c1"># get the formatted reprs</span>
        <span class="n">this_repr</span> <span class="o">=</span> <span class="n">this_cont</span><span class="o">.</span><span class="n">with_default_key_color</span><span class="p">(</span><span class="s1">&#39;green&#39;</span><span class="p">)</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
        <span class="n">this_repr_red</span> <span class="o">=</span> <span class="n">this_cont</span><span class="o">.</span><span class="n">with_default_key_color</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
        <span class="n">this_repr_stripped</span> <span class="o">=</span> <span class="n">ansi_escape</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">this_repr</span><span class="p">)</span>
        <span class="n">sub_repr</span> <span class="o">=</span> <span class="n">sub_cont</span><span class="o">.</span><span class="n">with_default_key_color</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

        <span class="c1"># remove the outer brackets from the sub repr</span>
        <span class="n">sub_repr</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sub_repr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1"># find the sub-container placeholder</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">this_repr_stripped</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;SUB_CONT: null&#39;</span><span class="p">)</span>

        <span class="c1"># count the lines above and below the sub-container</span>
        <span class="n">num_lines_above</span> <span class="o">=</span> <span class="n">this_repr_stripped</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">num_lines_below</span> <span class="o">=</span> <span class="n">this_repr_stripped</span><span class="p">[</span><span class="n">idx</span><span class="p">:]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># get the str reprs above and below</span>
        <span class="n">this_repr_split</span> <span class="o">=</span> <span class="n">this_repr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">this_repr_red_split</span> <span class="o">=</span> <span class="n">this_repr_red</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">this_repr_above</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">this_repr_split</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num_lines_above</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">this_repr_red_split</span><span class="p">[</span><span class="n">num_lines_above</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">this_repr_below</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">this_repr_split</span><span class="p">[</span><span class="o">-</span><span class="n">num_lines_below</span><span class="p">:])</span>

        <span class="c1"># count the number of lines needed to be prepended to the sub-container repr</span>
        <span class="n">cur_num_spaces</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sub_repr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">cur_num_spaces</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">exp_num_spaces</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">this_repr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="n">num_lines_above</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">exp_num_spaces</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">num_spaces_to_add</span> <span class="o">=</span> <span class="n">exp_num_spaces</span> <span class="o">-</span> <span class="n">cur_num_spaces</span>

        <span class="c1"># prepend these lines to the sub-container</span>
        <span class="n">sub_repr</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39; &#39;</span><span class="o">*</span><span class="n">num_spaces_to_add</span> <span class="o">+</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sub_repr</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1"># show</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">this_repr_above</span> <span class="o">+</span> <span class="n">sub_repr</span> <span class="o">+</span> <span class="n">this_repr_below</span><span class="p">)</span></div>

    <span class="c1"># Built-ins #</span>
    <span class="c1"># ----------#</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">as_repr</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

        <span class="n">indent_str</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_print_indent</span>

        <span class="k">def</span> <span class="nf">_align_array</span><span class="p">(</span><span class="n">array_str_in</span><span class="p">):</span>
            <span class="n">array_str_in_split</span> <span class="o">=</span> <span class="n">array_str_in</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;([&#39;</span><span class="p">)</span>
            <span class="n">leading_str_to_keep</span> <span class="o">=</span> <span class="n">array_str_in_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">n&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">indented_key_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">leading_str_to_keep</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;: &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">indented_key_str</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">*</span><span class="p">(</span><span class="n">indented_key_size</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">padded</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">def</span> <span class="nf">_pre_pad_alpha_line</span><span class="p">(</span><span class="n">str_in</span><span class="p">):</span>
                <span class="k">nonlocal</span> <span class="n">padded</span>
                <span class="n">padded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">n&#39;</span> <span class="o">+</span> <span class="n">indent_str</span> <span class="o">+</span> <span class="n">indented_key_str</span> <span class="o">+</span> <span class="n">str_in</span>

            <span class="n">leading_str_to_keep</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_pre_pad_alpha_line</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">s</span>
                                             <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">leading_str_to_keep</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))])</span>
            <span class="n">local_indent_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">padded</span> <span class="k">else</span> <span class="n">indent_str</span>
            <span class="n">leading_str</span> <span class="o">=</span> <span class="n">leading_str_to_keep</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">n&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">remaining_str</span> <span class="o">=</span> <span class="n">array_str_in_split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">num_extra_dims</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">remaining_str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">char</span> <span class="o">!=</span> <span class="s1">&#39;[&#39;</span><span class="p">:</span>
                    <span class="n">num_extra_dims</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="k">break</span>
            <span class="n">extra_indent</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">leading_str</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">num_extra_dims</span><span class="p">)</span> <span class="o">*</span> <span class="s1">&#39; &#39;</span>
            <span class="n">array_str_in</span> <span class="o">=</span> <span class="s1">&#39;([&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">leading_str_to_keep</span><span class="p">,</span> <span class="n">remaining_str</span><span class="p">])</span>
            <span class="n">uniform_indent_wo_overflow</span> <span class="o">=</span> <span class="n">array_str_in</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">n[&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">local_indent_str</span> <span class="o">+</span> <span class="n">extra_indent</span> <span class="o">+</span> <span class="s1">&#39;[&#39;</span><span class="p">)</span>
            <span class="n">uniform_indent</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">local_indent_str</span> <span class="o">+</span> <span class="n">extra_indent</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">s</span>
                                        <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="ow">or</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">or</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;...&#39;</span> <span class="ow">or</span>
                                            <span class="nb">max</span><span class="p">([</span><span class="n">ss</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;nan, &#39;</span><span class="p">,</span> <span class="s1">&#39;inf, &#39;</span><span class="p">]]))</span> <span class="k">else</span>
                                        <span class="p">(</span><span class="n">indent_str</span> <span class="o">+</span> <span class="n">indented_key_str</span> <span class="o">+</span> <span class="n">s</span>
                                         <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isspace</span><span class="p">()</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
                                         <span class="k">else</span> <span class="n">s</span><span class="p">)</span>
                                        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">uniform_indent_wo_overflow</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">n&#39;</span><span class="p">)])</span>
            <span class="n">indented</span> <span class="o">=</span> <span class="n">uniform_indent</span>
            <span class="c1"># 10 dimensions is a sensible upper bound for the number in a single array</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
                <span class="n">indented</span> <span class="o">=</span> <span class="n">indented</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;[&#39;</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;[&#39;</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
                <span class="n">indented</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">indented</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">isspace</span><span class="p">()])</span>
            <span class="k">return</span> <span class="n">indented</span>

        <span class="k">def</span> <span class="nf">_align_arrays</span><span class="p">(</span><span class="n">str_in</span><span class="p">):</span>
            <span class="n">chunks</span> <span class="o">=</span> <span class="n">str_in</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">indent_str</span><span class="p">)</span>
            <span class="n">aligned_array_chunks</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">_align_array</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">n&#39;</span> <span class="ow">in</span> <span class="n">c</span><span class="p">}</span>
            <span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">aligned_array_chunks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">aligned_array_chunks</span> <span class="k">else</span> <span class="n">c_orig</span>
                      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c_orig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chunks</span><span class="p">)]</span>
            <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">indent_str</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span>

        <span class="n">new_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="c1"># noinspection PyArgumentList</span>
                <span class="n">rep</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="n">as_repr</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print_limit</span><span class="p">)</span> <span class="ow">and</span> \
                        <span class="n">_reduce</span><span class="p">(</span><span class="n">_mul</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_limit</span><span class="p">:</span>
                    <span class="n">rep</span> <span class="o">=</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="s2">&quot;shape=&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="n">v</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">is_array</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">rep</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;list[</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;shape=&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">rep</span> <span class="o">=</span> <span class="n">v</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rep</span>
        <span class="k">if</span> <span class="n">as_repr</span><span class="p">:</span>
            <span class="n">json_dumped_str</span> <span class="o">=</span> <span class="n">_align_arrays</span><span class="p">(</span><span class="n">_json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="n">Container</span><span class="p">(</span><span class="n">new_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">_is_jsonable</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                    <span class="k">else</span> <span class="n">_repr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span>
                <span class="n">indent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_print_indent</span><span class="p">))</span>

            <span class="k">def</span> <span class="nf">_add_newline</span><span class="p">(</span><span class="n">str_in</span><span class="p">):</span>
                <span class="n">str_in_split</span> <span class="o">=</span> <span class="n">str_in</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">str_split_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_in_split</span><span class="p">)</span>
                <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_print_line_spacing</span> <span class="o">+</span> <span class="n">ss</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="p">(</span><span class="n">str_split_size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="n">ss</span>
                                  <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ss</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">str_in_split</span><span class="p">)])</span>

            <span class="n">json_dumped_str</span> <span class="o">=</span> <span class="s1">&#39;&quot;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_add_newline</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">json_dumped_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)])</span>
            <span class="c1"># improve tf formatting</span>
            <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">framework_stack</span> <span class="ow">and</span> <span class="n">ivy</span><span class="o">.</span><span class="n">current_framework_str</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;tensorflow&#39;</span><span class="p">:</span>
                <span class="n">json_dumped_str_split</span> <span class="o">=</span> <span class="n">json_dumped_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">Variable:&quot;</span><span class="p">)</span>
                <span class="n">json_dumped_str</span> <span class="o">=</span> <span class="n">json_dumped_str_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ss</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
                                                                               <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">json_dumped_str_split</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
                <span class="n">json_dumped_str</span> <span class="o">=</span> <span class="n">json_dumped_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:shape&#39;</span><span class="p">,</span> <span class="s1">&#39;, shape&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)dtype=&#39;</span><span class="p">,</span> <span class="s1">&#39;), dtype=&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="s1">&#39;, ),&#39;</span><span class="p">,</span> <span class="s1">&#39;,),&#39;</span><span class="p">)</span>
            <span class="c1"># color keys</span>
            <span class="n">json_dumped_str_split</span> <span class="o">=</span> <span class="n">json_dumped_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
            <span class="n">split_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">json_dumped_str_split</span><span class="p">)</span>
            <span class="n">json_dumped_str</span> <span class="o">=</span>\
                <span class="s1">&#39;&quot;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39; &quot;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sub_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &quot;&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                                     <span class="p">[</span><span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span>
                                         <span class="n">Container</span><span class="o">.</span><span class="n">trim_key</span><span class="p">(</span><span class="n">sub_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &quot;&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_length_limit</span><span class="p">),</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">_default_key_color</span><span class="p">)])</span>
                           <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">split_size</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">sub_str</span>
                           <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sub_str</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">json_dumped_str_split</span><span class="p">)])</span>
            <span class="c1"># remove quotation marks, shape tuple, and color other elements of the dict</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">json_dumped_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;, &#39;shape=&#39;, [&quot;</span><span class="p">,</span> <span class="s2">&quot; shape=[&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;magenta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">,</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;shape=&#39;</span><span class="p">,</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="s1">&#39;shape=&#39;</span><span class="p">,</span> <span class="s1">&#39;magenta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="s1">&#39;device=&#39;</span><span class="p">,</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="s1">&#39;device=&#39;</span><span class="p">,</span> <span class="s1">&#39;magenta&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;class&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;class &#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;class&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span> <span class="o">+</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">))</span>
            <span class="c1"># ToDo: make the solution below more elegant</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;diff_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="s1">&#39;diff_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keyword_color_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">keyword</span><span class="p">,</span> <span class="n">termcolor</span><span class="o">.</span><span class="n">colored</span><span class="p">(</span><span class="n">keyword</span><span class="p">,</span> <span class="n">color</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">ret</span>
        <span class="k">return</span> <span class="n">new_dict</span>

    <span class="k">def</span> <span class="fm">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">super</span><span class="o">.</span><span class="fm">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="c1"># noinspection PyProtectedMember</span>
    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="c1"># noinspection PyUnresolvedReferences</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="o">.</span><span class="fm">__getattr__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;_&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_queue_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">queue_queries</span> <span class="o">=</span> <span class="p">[</span><span class="n">query</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">queue_queries</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">query</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">step</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">queue_queries</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">query</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">query</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">query</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">step</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Invalid slice type, must be one of integer, slice, or sequences of slices.&#39;</span><span class="p">)</span>
        <span class="n">queue_idxs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">_np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">q</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queue_load_sizes_cum</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">queue_queries</span><span class="p">])</span>
        <span class="n">conts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">queue_idxs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loaded_containers_from_queues</span><span class="p">:</span>
                <span class="n">cont</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queue_timeout</span><span class="p">),</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span><span class="o">.</span><span class="n">to_ivy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded_containers_from_queues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cont</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loaded_containers_from_queues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">conts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span>
        <span class="n">combined_cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_container_combine_method</span><span class="p">(</span><span class="n">conts</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">queue_idxs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queue_load_sizes_cum</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">shifted_query</span> <span class="o">=</span> <span class="n">query</span> <span class="o">-</span> <span class="n">offset</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">shifted_query</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">start</span><span class="o">-</span><span class="n">offset</span><span class="p">,</span> <span class="n">query</span><span class="o">.</span><span class="n">stop</span><span class="o">-</span><span class="n">offset</span><span class="p">,</span> <span class="n">query</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">shifted_query</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">slice</span><span class="p">(</span><span class="n">slc</span><span class="o">.</span><span class="n">start</span><span class="o">-</span><span class="n">offset</span><span class="p">,</span> <span class="n">slc</span><span class="o">.</span><span class="n">stop</span><span class="o">-</span><span class="n">offset</span><span class="p">,</span> <span class="n">slc</span><span class="o">.</span><span class="n">step</span><span class="p">)</span> <span class="k">for</span> <span class="n">slc</span> <span class="ow">in</span> <span class="n">query</span><span class="p">])</span>
        <span class="c1"># noinspection PyUnboundLocalVariable</span>
        <span class="k">return</span> <span class="n">combined_cont</span><span class="p">[</span><span class="n">shifted_query</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get slice, key or key chain of container object.</span>

<span class="sd">        :param query: slice object, key or key chain to query all container elements.</span>
<span class="sd">        :type query: slice or str</span>
<span class="sd">        :return: Container object at desired query.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">query</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span>
            <span class="k">if</span> <span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">query</span> <span class="ow">or</span> <span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">query</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">at_key_chain</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">ret</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ret</span>
        <span class="k">elif</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queues</span><span class="p">):</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_queue_item</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ret</span>
        <span class="n">return_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="n">query</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># noinspection PyBroadException</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="n">query</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;shape&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">():</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="n">query</span><span class="p">]</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="n">return_dict</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set key or key chain of container object.</span>

<span class="sd">        :param query: slice object, key or key chain at which to set all container elements.</span>
<span class="sd">        :type query: slice or str</span>
<span class="sd">        :param val: The value to set at the desired query.</span>
<span class="sd">        :type val: ivy.Container, array, or other</span>
<span class="sd">        :return: New container after updating.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">query</span> <span class="ow">or</span> <span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">query</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_at_key_chain</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">key</span> <span class="ow">or</span> <span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_key_chain</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains_sub_container</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">power</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">power</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_reduce</span><span class="p">(</span><span class="n">_pow</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="n">power</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">power</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">power</span> <span class="o">**</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">],</span> <span class="nb">sum</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">other</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="n">other</span><span class="p">],</span> <span class="nb">sum</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="o">-</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span> <span class="o">+</span> <span class="n">other</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_reduce</span><span class="p">(</span><span class="n">_mul</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="o">*</span> <span class="n">other</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_reduce</span><span class="p">(</span><span class="n">_truediv</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="o">/</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">other</span> <span class="o">/</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_reduce</span><span class="p">(</span><span class="n">_floordiv</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="o">//</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rfloordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">other</span> <span class="o">//</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_reduce</span><span class="p">(</span><span class="n">_lt</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_reduce</span><span class="p">(</span><span class="n">_le</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_reduce</span><span class="p">(</span><span class="n">_eq</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_reduce</span><span class="p">(</span><span class="n">_ne</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_reduce</span><span class="p">(</span><span class="n">_gt</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_reduce</span><span class="p">(</span><span class="n">_ge</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rand__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">other</span> <span class="ow">and</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="ow">or</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ror__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">other</span> <span class="ow">or</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__invert__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">_not</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rxor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">other</span> <span class="o">!=</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="n">state_dict</span><span class="p">[</span><span class="s1">&#39;_local_ivy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">try_else_none</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">state_dict</span><span class="p">[</span><span class="s1">&#39;_local_ivy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">current_framework_str</span><span class="p">())</span>
        <span class="n">config_in</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">state_dict</span><span class="p">[</span><span class="s1">&#39;_config_in&#39;</span><span class="p">])</span>
        <span class="n">config_in</span><span class="p">[</span><span class="s1">&#39;ivyh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">try_else_none</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">config_in</span><span class="p">[</span><span class="s1">&#39;ivyh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">current_framework_str</span><span class="p">())</span>
        <span class="n">state_dict</span><span class="p">[</span><span class="s1">&#39;_config_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config_in</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">state_dict</span><span class="p">[</span><span class="s1">&#39;_config&#39;</span><span class="p">])</span>
        <span class="n">config</span><span class="p">[</span><span class="s1">&#39;ivyh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">try_else_none</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;ivyh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">current_framework_str</span><span class="p">())</span>
        <span class="n">state_dict</span><span class="p">[</span><span class="s1">&#39;_config&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config</span>
        <span class="k">return</span> <span class="n">state_dict</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;_local_ivy&#39;</span> <span class="ow">in</span> <span class="n">state_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">state_dict</span><span class="p">[</span><span class="s1">&#39;_local_ivy&#39;</span><span class="p">]):</span>
                <span class="n">state_dict</span><span class="p">[</span><span class="s1">&#39;_local_ivy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">get_framework</span><span class="p">(</span><span class="n">state_dict</span><span class="p">[</span><span class="s1">&#39;_local_ivy&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;_config_in&#39;</span> <span class="ow">in</span> <span class="n">state_dict</span><span class="p">:</span>
            <span class="n">config_in</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">state_dict</span><span class="p">[</span><span class="s1">&#39;_config_in&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;ivyh&#39;</span> <span class="ow">in</span> <span class="n">config_in</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config_in</span><span class="p">[</span><span class="s1">&#39;ivyh&#39;</span><span class="p">]):</span>
                    <span class="n">config_in</span><span class="p">[</span><span class="s1">&#39;ivyh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">get_framework</span><span class="p">(</span><span class="n">config_in</span><span class="p">[</span><span class="s1">&#39;ivyh&#39;</span><span class="p">])</span>
            <span class="n">state_dict</span><span class="p">[</span><span class="s1">&#39;_config_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config_in</span>
        <span class="k">if</span> <span class="s1">&#39;_config&#39;</span> <span class="ow">in</span> <span class="n">state_dict</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">state_dict</span><span class="p">[</span><span class="s1">&#39;_config&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;ivyh&#39;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ivy</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;ivyh&#39;</span><span class="p">]):</span>
                    <span class="n">config</span><span class="p">[</span><span class="s1">&#39;ivyh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">get_framework</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;ivyh&#39;</span><span class="p">])</span>
            <span class="n">state_dict</span><span class="p">[</span><span class="s1">&#39;_config&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state_dict</span><span class="p">)</span>

    <span class="c1"># Getters and Setters #</span>
    <span class="c1"># --------------------#</span>

    <span class="c1"># private</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_ivy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ivy</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_local_ivy</span><span class="p">,</span> <span class="n">ivy</span><span class="p">)</span>

    <span class="nd">@_ivy</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">_ivy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">local_ivy</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_local_ivy</span> <span class="o">=</span> <span class="n">local_ivy</span>

    <span class="c1"># public</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The shape of the arrays in the container, with None placed in indices which are not consistent across arrays</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_shape</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The shapes of each array in the container, with None placed in leaf entries without a shape attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_shapes</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dev</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The device to which the arrays in the container belong, with None returned if the devices are not consistent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dev</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dev_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The device to which the arrays in the container belong, with None returned if the devices are not consistent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dev</span><span class="p">(</span><span class="n">as_str</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ivy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ivy</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">max_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">kcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">kc</span> <span class="k">for</span> <span class="n">kc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_iterator_keys</span><span class="p">(</span><span class="n">include_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">kcs</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">kc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">))</span> <span class="k">for</span> <span class="n">kc</span> <span class="ow">in</span> <span class="n">kcs</span><span class="p">])</span></div>


<div class="viewcode-block" id="MultiDevContainer"><a class="viewcode-back" href="../../container/MultiDevContainer.html#ivy.container.MultiDevContainer">[docs]</a><span class="k">class</span> <span class="nc">MultiDevContainer</span><span class="p">(</span><span class="n">Container</span><span class="p">):</span>

<div class="viewcode-block" id="MultiDevContainer.__init__"><a class="viewcode-back" href="../../container/MultiDevContainer.html#ivy.container.MultiDevContainer.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dict_in</span><span class="p">,</span> <span class="n">devs</span><span class="p">,</span> <span class="n">queues</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">queue_load_sizes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">container_combine_method</span><span class="o">=</span><span class="s1">&#39;list_join&#39;</span><span class="p">,</span>
                 <span class="n">queue_timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">print_indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">print_line_spacing</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ivyh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">keyword_color_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rebuild_child_containers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dict_in</span><span class="p">,</span> <span class="n">queues</span><span class="p">,</span> <span class="n">queue_load_sizes</span><span class="p">,</span> <span class="n">container_combine_method</span><span class="p">,</span> <span class="n">queue_timeout</span><span class="p">,</span> <span class="n">print_limit</span><span class="p">,</span>
                         <span class="n">print_indent</span><span class="p">,</span> <span class="n">print_line_spacing</span><span class="p">,</span> <span class="n">ivyh</span><span class="p">,</span> <span class="n">keyword_color_dict</span><span class="p">,</span> <span class="n">rebuild_child_containers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_devs</span> <span class="o">=</span> <span class="n">devs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_devs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">devs</span><span class="p">)</span></div>

<div class="viewcode-block" id="MultiDevContainer.at_dev"><a class="viewcode-back" href="../../container/MultiDevContainer.html#ivy.container.MultiDevContainer.at_dev">[docs]</a>    <span class="k">def</span> <span class="nf">at_dev</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dev</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">kc</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">dev</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">MultiDevItem</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span></div>

<div class="viewcode-block" id="MultiDevContainer.at_devs"><a class="viewcode-back" href="../../container/MultiDevContainer.html#ivy.container.MultiDevContainer.at_devs">[docs]</a>    <span class="k">def</span> <span class="nf">at_devs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">ds</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">at_dev</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_devs</span><span class="p">}</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Ivy Team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>